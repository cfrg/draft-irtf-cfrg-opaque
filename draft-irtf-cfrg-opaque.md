---
title: The OPAQUE Asymmetric PAKE Protocol
abbrev: OPAQUE
docname: draft-irtf-cfrg-opaque-latest
date:
category: info

ipr: trust200902
keyword: Internet-Draft

stand_alone: yes
pi: [toc, sortrefs, symrefs]

author:
 -
    ins: H. Krawczyk
    name: Hugo Krawczyk
    organization: Algorand Foundation
    email: hugokraw@gmail.com
 -
    ins: K. Lewi
    name: Kevin Lewi
    organization: Novi Research
    email: lewi.kevin.k@gmail.com
 -
    ins: C. A. Wood
    name: Christopher A. Wood
    organization: Cloudflare
    email: caw@heapingbits.net

informative:

  Boyen09:
    title: "HPAKE: Password authentication secure against cross-site user
impersonation"
    author:
      -
        ins: X. Boyen
        name: Xavier Boyen

    seriesinfo: Cryptology and Network Security (CANS)
    date: 2009

  BG04:
    title: The static Diffie-Hellman problem
    author:
      -
        ins: D. Brown
        name: Daniel R. L. Brown
      -
        ins: R. Galant
        name: Robert P. Galant

    seriesinfo: http://eprint.iacr.org/2004/306
    date: 2004

  Canetti01:
    title: "Universally composable security: A new paradigm for cryptographic
protocols"
    author:
      -
        ins: R. Canetti
        name: Ran Canetti

    seriesinfo: IEEE Symposium on Foundations of Computer Science (FOCS)
    date: 2001

  Cheon06:
    title: Security analysis of the strong Diffie-Hellman problem
    author:
      -
        ins: J. H. Cheon
        name: Jung Hee Cheon

    seriesinfo: Euroctypt 2006
    date: 2006

  FK00:
    title: Server-assisted generation of a strong secret from a password
    author:
      -
        ins: W. Ford
        name: Warwick Ford
      -
        ins: B. S. Kaliski, Jr
        name: Burton S. Kaliski, Jr

    seriesinfo: WETICE
    date: 2000

  GMR06:
    title: "A method for making password-based
key exchange resilient to server compromise"

    author:
      -
        ins: C. Gentry
        name: Craig Gentry
      -
        ins: P. MacKenzie
        name: Phil MacKenzie
      -
        ins: Z, Ramzan
        name: Zulfikar Ramzan

    seriesinfo: CRYPTO
    date: 2006

  AuCPace:
    title: "AuCPace: Efficient verifier-based PAKE protocol tailored for the IIoT"
    author:
      -
        ins: B. Haase
        name: Bjorn Haase
      -
        ins: B. Labrique
        name: Benoit Labrique

    seriesinfo: http://eprint.iacr.org/2018/286
    date: 2018

  I-D.irtf-cfrg-hash-to-curve:
  I-D.irtf-cfrg-voprf:
  I-D.sullivan-tls-opaque:

  keyagreement: DOI.10.6028/NIST.SP.800-56Ar3

  OPAQUE:
    title: "OPAQUE: An Asymmetric PAKE Protocol Secure Against Pre-Computation
    Attacks"
    # see the quotes above? Needed because of the embedded colon.
    author:
      -
        ins: S. Jarecki
        name: Stanislaw Jarecki
      -
        ins: H. Krawczyk
        name: Hugo Krawczyk
      -
        ins: J. Xu
        name: Jiayu Xu
    seriesinfo: Eurocrypt
    date: 2018

  JKKX16:
    title: "Highly-efficient and composable
password-protected secret sharing (or: how to protect your bitcoin wallet
online)"
    # see the quotes above? Needed because of the embedded colon.
    author:
      -
        ins: S. Jarecki
        name: Stanislaw Jarecki
      -
        ins: A. Kiayias
        name: Aggelos Kiayias
      -
        ins: H. Krawczyk
        name: Hugo Krawczyk
      -
        ins: J. Xu
        name: Jiayu Xu
    seriesinfo: IEEE European Symposium on Security and Privacy
    date: 2016

  LGR20:
    title: Partitioning Oracle Attacks
    target: https://eprint.iacr.org/2020/1491.pdf
    author:
      -
        ins: J. Len
        name: Julia Len
      -
        ins: P. Grubbs
        name: Paul Grubbs
      -
        ins: T. Ristenpart
        name: Thomas Ristenpart

  SIGMA:
    title: "SIGMA: The SIGn-and-MAc approach to authenticated Diffie-Hellman and its use in the IKE protocols"
    author:
      -
        ins: H. Krawczyk
        name: Hugo Krawczyk

    seriesinfo: CRYPTO
    date: 2003

  HMQV:
    title: "HMQV: A high-performance secure Diffie-Hellman protocol"
    author:
      -
        ins: H. Krawczyk
        name: Hugo Krawczyk

    seriesinfo: CRYPTO
    date: 2005

  SPAKE2plus:
    title: "Security Analysis of SPAKE2+"
    author:
      -
        ins: V. Shoup
        name: Victor Shoup

    seriesinfo: http://eprint.iacr.org/2020/313
    date: 2020

  SIGNAL:
    title: "Signal recommended cryptographic algorithms"
    seriesinfo: https://signal.org/docs/specifications/doubleratchet/#recommended-cryptographic-algorithms
    date: 2016

  RFC2945:
  RFC5869:
  RFC8125:
  RFC8446:

--- abstract

This document describes the OPAQUE protocol, a secure asymmetric
password-authenticated key exchange (aPAKE) that supports mutual
authentication in a client-server setting without reliance on PKI and
with security against pre-computation attacks upon server compromise.
In addition, the protocol provides forward secrecy and the ability to
hide the password from the server, even during password registration.
This document specifies the core OPAQUE protocol, along with several
instantiations in different authenticated key exchange protocols.

--- middle

# Introduction {#intro}

Password authentication is the prevalent form of authentication in
the web and in many other applications. In the most common
implementation, a client authenticates to a server by sending its client
ID and password to the server over a TLS connection. This makes
the password vulnerable to server mishandling, including accidentally
logging the password or storing it in cleartext in a database. Server
compromise resulting in access to these plaintext passwords is not an
uncommon security incident, even among security-conscious companies.
Moreover, plaintext password authentication over TLS is also vulnerable
to TLS failures, including many forms of PKI attacks, certificate
mishandling, termination outside the security perimeter, visibility
to middle boxes, and more.

Asymmetric (or Augmented) Password Authenticated Key Exchange (aPAKE)
protocols are designed to provide password authentication and
mutually authenticated key exchange in a client-server setting without relying on PKI (except
during client/password registration) and without disclosing passwords
to servers or other entities other than the client machine. A secure
aPAKE should provide the best possible security for a password
protocol. Namely, it should only be open to inevitable attacks, such as
online impersonation attempts with guessed client passwords and offline
dictionary attacks upon the compromise of a server and leakage of its
password file. In the latter case, the attacker learns a mapping of
a client's password under a one-way function and uses such a mapping to
validate potential guesses for the password. Crucially important is
for the password protocol to use an unpredictable one-way mapping.
Otherwise, the attacker can pre-compute a deterministic list of mapped
passwords leading to almost instantaneous leakage of passwords upon
server compromise.

Despite the existence of multiple designs for
(PKI-free) aPAKE protocols, none of these protocols are secure against
pre-computation attacks. In particular, none of these protocols can
use the standard technique against pre-computation that combines
_secret_ random values ("salt") into the one-way password mappings.
Either these protocols do not use a salt at all or, if they do, they
transmit the salt from server to client in the clear, hence losing the
secrecy of the salt and its defense against pre-computation. Furthermore,
transmitting the salt may require additional protocol messages.

This document describes OPAQUE, a PKI-free secure aPAKE that is secure
against pre-computation attacks and capable of using a secret salt.
OPAQUE provides forward secrecy (essential for
protecting past communications in case of password leakage) and the
ability to hide the password from the server - even during password
registration. Furthermore, OPAQUE enjoys good performance and an array of additional
features including the ability to increase
the difficulty of offline dictionary attacks via iterated hashing
or other hardening schemes, and offloading these operations to the
client (that also helps against online guessing attacks); extensibility of
the protocol to support storage and
retrieval of client's secrets solely based on a password; and being
amenable to a multi-server distributed implementation where offline
dictionary attacks are not possible without breaking into a threshold
of servers (such a distributed solution requires no change or awareness
on the client side relative to a single-server implementation).

OPAQUE is defined and proven as the composition of two functionalities:
an oblivious pseudorandom function (OPRF) and an authenticated key exchange (AKE) protocol. It can be seen
as a "compiler" for transforming any suitable AKE protocol into a secure
aPAKE protocol. (See {{security-considerations}} for requirements of the
OPRF and AKE protocols.) This document specifies one OPAQUE instantiation
based on 3DH {{SIGNAL}}. Other instantiations are possible, as discussed in
{{alternate-akes}}, but their details are out of scope for this document.
In general, the modularity of OPAQUE's design makes it easy to integrate with
additional AKE protocols, e.g., IKEv2, and with future ones such as those
based on post-quantum techniques.

OPAQUE consists of two stages: registration and authenticated key exchange.
In the first stage, a client registers its password with the server and stores
its encrypted credentials on the server. In the second stage, a client obtains
those credentials, recovers them using the client's password, and subsequently uses
them as input to an AKE protocol.

Currently, the most widely deployed PKI-free aPAKE is SRP {{?RFC2945}}, which is
vulnerable to pre-computation attacks, lacks a proof of security, and is less efficient
relative to OPAQUE. Moreover, SRP requires a ring as it mixes addition and
multiplication operations, and thus does not work over plain elliptic curves. OPAQUE
is therefore a suitable replacement for applications that use SRP.

This draft complies with the requirements for PAKE protocols set forth in
{{RFC8125}}.

## Requirements Notation

{::boilerplate bcp14}

## Notation

The following terms are used throughout this document to describe the
operations, roles, and behaviors of OPAQUE:

- Client (C): Entity which has knowledge of a password and wishes to authenticate.
- Server (S): Entity which authenticates clients using passwords.
- password: An opaque byte string containing the client's password.
- (client/server_private_key, client/server_public_key): An AKE key pair used by
  either the client and server, denoting either the private or public key. For example,
  (client_private_key, client_public_key) refers to C's private and public key.
- oprf_key: An OPRF private key known only to the server.
- I2OSP and OS2IP: Convert a byte string to and from a non-negative integer as
  described in Section 4 of {{?RFC8017}}. Note that these functions operate on byte strings in
  big-endian byte order.
- concat(x0, ..., xN): Concatenate byte strings. For example,
  `concat(0x01, 0x0203, 0x040506) = 0x010203040506`.
- random(n): Generate a cryptographically secure pseudorandom byte string of length `n` bytes.
- xor(a,b): Apply XOR to byte strings. For example, `xor(0xF0F0, 0x1234) = 0xE2C4`.
  It is an error to call this function with two arguments of unequal
  length.
- ct_equal(a, b): Return `true` if `a` is equal to `b`, and false otherwise.
  This function is constant-time in the length of `a` and `b`, which are assumed
  to be of equal length, irrespective of the values `a` or `b`.

Except if said otherwise, random choices in this specification refer to
drawing with uniform distribution from a given set (i.e., "random" is short
for "uniformly random"). Random choices can be replaced with fresh outputs from
a cryptographically strong pseudorandom generator, according to the requirements
in {{!RFC4086}}, or pseudorandom function.

The name OPAQUE is a homonym of O-PAKE where O is for Oblivious. The name
OPAKE was taken.

# Cryptographic Protocol and Algorithm Dependencies {#dependencies}

OPAQUE relies on the following protocols and primitives:

- Oblivious Pseudorandom Function (OPRF, {{I-D.irtf-cfrg-voprf}}):
  - Blind(x): Convert input `x` into an element of the OPRF group, randomize it
    by some scalar `r`, producing `M`, and output (`r`, `M`).
  - KeyGen(): Generate an OPRF private and public key. OPAQUE only requires an
    OPRF private key. We write `(oprf_key, _) = KeyGen()` to denote use of this
    function for generating secret key `oprf_key` (and discarding the corresponding
    public key).
  - Evaluate(k, M): Evaluate input element `M` using private key `k`, yielding
    output element `Z`.
  - Unblind(r, Z): Remove random scalar `r` from `Z`, yielding output `N`.
  - Finalize(x, N, info): Compute the OPRF output using input `x`, `N`, and domain
    separation tag `info`.
  - SerializeScalar(s): Map a scalar `s` to a unique byte array `buf` of fixed
    length.
  - DeserializeScalar(buf): Map a byte array `buf` to a scalar `s`, or fail if
    the input is not a valid byte representation of a scalar.
  - SerializedElement: A serialized OPRF group element, a byte array of fixed
    length.
  - SerializedScalar: A serialized OPRF scalar, a byte array of fixed length.\

Note that we only need the base mode variant (as opposed to the verifiable mode
variant) of the OPRF described in {{I-D.irtf-cfrg-voprf}}.

- Cryptographic hash function:
  - Hash(m): Compute the cryptographic hash of input message `m`. The type of the
    hash is determined by the chosen OPRF group.
  - Nh: The output size of the Hash function.

- Authenticated Key Exchange (AKE, {{instantiations}}):
  - Npk: The size of the public keys used for the key exchange protocol
  - Nsk: The size of the private keys used for the key exchange protocol

- Memory Hard Function (MHF):
  - Harden(msg, params): Repeatedly apply a memory hard function with parameters
    `params` to strengthen the input `msg` against offline dictionary attacks.
    This function also needs to satisfy collision resistance.


# Offline Registration {#offline-phase}

Registration is executed between a client C and a
server S. It is assumed S can identify C and the client can
authenticate S during this registration phase. This is the only part
in OPAQUE that requires an authenticated channel, either physical, out-of-band,
PKI-based, etc. This section describes the registration flow, message encoding,
and helper functions. Moreover, C has a key pair (client_private_key, client_public_key) for an AKE protocol
which is suitable for use with OPAQUE; See {{online-phase}}. (client_private_key, client_public_key) may be
randomly generated for the account or provided by the calling client.
Clients MUST NOT use the same key pair (client_private_key, client_public_key) for two different accounts.

To begin, C chooses password password, and S chooses its own pair of private-public
keys server_private_key and server_public_key for use with the AKE. S can use
the same pair of keys with multiple clients. These steps can happen offline, i.e.,
before the registration phase. Once complete, the registration process proceeds as follows:

~~~
 Client (password, creds)            Server (server_private_key, server_public_key)
 --------------------------------------------------------------------
 (request, blind) = CreateRegistrationRequest(password)

                               request
                      ------------------------->

            (response, oprf_key) = CreateRegistrationResponse(request, server_public_key)

                               response
                      <-------------------------

 (record, export_key) = FinalizeRequest(password, creds, blind, response)

                                record
                      ------------------------->
~~~

{{registration-functions}} describes details of the functions referenced above.

Both client and server MUST validate the other party's public key before use.
See {{validation}} for more details.

Upon completion, S stores C's credentials for later use. See {{credential-file}}
for a recommended storage format.

## Credential Storage {#credential-storage}

OPAQUE makes use of a structure `Envelope` to store client credentials.
The `Envelope` structure embeds the following types of credentials:

- client_private_key: The encoded client private key for the AKE protocol.
- server_public_key: The encoded server public key for the AKE protocol.
- client_identity: The client identity. This is an application-specific value, e.g., an e-mail
  address or normal account name.
- server_identity: The server identity. This is typically a domain name, e.g., example.com.
  See {{identities}} for information about this identity.

Each public and private key value is an opaque byte string, specific to the AKE
protocol in which OPAQUE is instantiated. For example, if used as raw public keys
for TLS 1.3 {{?RFC8446}}, they may be RSA or ECDSA keys as per {{?RFC7250}}.

These credentials are incorporated in the `SecretCredentials` and `CleartextCredentials` structs,
depending on the mode set by the value of `EnvelopeMode`:

~~~
enum {
  base(1),
  custom_identifier(2),
  (255)
} EnvelopeMode;
~~~

The `base` mode defines `SecretCredentials` and `CleartextCredentials` as follows:

~~~
struct {
  opaque client_private_key[Nsk];
} SecretCredentials;

struct {
  opaque server_public_key[Npk];
} CleartextCredentials;
~~~

The `custom_identifier` mode defines `SecretCredentials` and `CleartextCredentials` as follows:

~~~
struct {
  opaque client_private_key[Nsk];
} SecretCredentials;

struct {
  opaque server_public_key[Npk];
  opaque client_identity<0..2^16-1>;
  opaque server_identity<0..2^16-1>;
} CleartextCredentials;
~~~

These credentials are embedded into the following `Envelope` structure with
encryption and authentication.

~~~
struct {
  EnvelopeMode mode;
  opaque nonce[32];
  opaque encrypted_creds[Nsk];
} InnerEnvelope;

struct {
  InnerEnvelope inner_env;
  opaque auth_tag[Nh];
} Envelope;
~~~

mode
: The `EnvelopeMode` value. This MUST be one of `base` or `custom_identifier`.

nonce
: A unique 32-byte nonce used to protect this Envelope.

encrypted_creds
: Encoding of encrypted and authenticated `SecretCredentials`.

auth_tag
: Authentication tag protecting the contents of the envelope,
covering `InnerEnvelope` and `CleartextCredentials`.

The full procedure for constructing `Envelope` and `InnerEnvelope` from
`SecretCredentials` and `CleartextCredentials` is described in {{finalize-request}}.
Note that only `SecretCredentials` are stored in the `Envelope` (in encrypted form).

The `EnvelopeMode` value is specified as part of the configuration (see {{configurations}}).

Credential information corresponding to the configuration-specific mode,
along with the client public key `client_public_key` and private key `client_private_key`,
are recommended to be stored in a `Credentials` object with the following named fields:

- `client_private_key`, the client's private key
- `client_public_key`, the client's public key corresponding to `client_private_key`
- `client_identity`, an optional client identity (present only in the `custom_identifier` mode)
- `server_identity`, an optional server identity (present only in the `custom_identifier` mode)

## Registration Messages

~~~
struct {
    SerializedElement data;
} RegistrationRequest;
~~~

data
: A serialized OPRF group element.

~~~
struct {
    SerializedElement data;
    opaque server_public_key[Npk];
} RegistrationResponse;
~~~

data
: A serialized OPRF group element.

server_public_key
: The server's encoded public key that will be used for the online authenticated key exchange stage.

~~~
struct {
    opaque client_public_key[Npk];
    Envelope envelope;
} RegistrationUpload;
~~~

client_public_key
: The client's encoded public key, corresponding to the private key `client_private_key`.

envelope
: The client's `Envelope` structure.

## Registration Functions {#registration-functions}

### CreateRegistrationRequest

~~~
CreateRegistrationRequest(password)

Input:
- password, an opaque byte string containing the client's password

Output:
- request, a RegistrationRequest structure
- blind, an OPRF scalar value

Steps:
1. (blind, M) = Blind(password)
2. Create RegistrationRequest request with M
3. Output (request, blind)
~~~

### CreateRegistrationResponse {#create-reg-response}

~~~
CreateRegistrationResponse(request, server_public_key)

Input:
- request, a RegistrationRequest structure
- server_public_key, the server's public key

Output:
- response, a RegistrationResponse structure
- oprf_key, the per-client OPRF key known only to the server

Steps:
1. (oprf_key, _) = KeyGen()
2. Z = Evaluate(oprf_key, request.data)
3. Create RegistrationResponse response with (Z, server_public_key)
4. Output (response, oprf_key)
~~~

### FinalizeRequest {#finalize-request}

~~~
FinalizeRequest(password, creds, blind, response)

Parameters:
- params, the MHF parameters established out of band
- mode, the InnerEnvelope mode
- Nh, the output size of the Hash function

Input:
- password, an opaque byte string containing the client's password
- creds, a Credentials structure
- blind, an OPRF scalar value
- response, a RegistrationResponse structure

Output:
- record, a RegistrationUpload structure
- export_key, an additional key

Steps:
1. N = Unblind(blind, response.data)
2. y = Finalize(password, N, "OPAQUE")
3. envelope_nonce = random(32)
4. prk = HKDF-Extract(envelope_nonce, Harden(y, params))
5. Create SecretCredentials secret_creds with creds.client_private_key
6. Create CleartextCredentials cleartext_creds with response.server_public_key
   and custom identifiers creds.client_identity and creds.server_identity if
   mode is custom_identifier
7. pseudorandom_pad =
     HKDF-Expand(prk, "Pad", len(secret_creds))
8. auth_key = HKDF-Expand(prk, "AuthKey", Nh)
9. export_key = HKDF-Expand(prk, "ExportKey", Nh)
10. encrypted_creds = xor(secret_creds, pseudorandom_pad)
11. Create InnerEnvelope inner_env
      with (mode, envelope_nonce, encrypted_creds)
12. auth_tag = HMAC(auth_key, concat(inner_env, cleartext_creds))
13. Create Envelope envelope with (inner_env, auth_tag)
14. Create RegistrationUpload record with (envelope, creds.client_public_key)
15. Output (record, export_key)
~~~

The inputs to HKDF-Extract and HKDF-Expand are as specified in {{RFC5869}}. The underlying hash function
is that which is associated with the OPAQUE configuration (see {{configurations}}).

See {{online-phase}} for details about the output export_key usage.

Upon completion of this function, the client MUST send `record` to the server.

### Credential File {#credential-file}

The server then constructs and stores the `credential_file` object, where `envelope` and `client_public_key`
are obtained from `record`, and `oprf_key` is retained from the output of `CreateRegistrationResponse`.
`oprf_key` is serialized using `SerializeScalar`. The below structure represents an example of how
these values might be conveniently stored together.

~~~
struct {
    SerializedScalar oprf_key;
    opaque client_public_key[Npk];
    Envelope envelope;
} credential_file;
~~~

# Online Authenticated Key Exchange {#online-phase}

After registration, the client and server run the authenticated
key exchange stage of the OPAQUE protocol. This stage is composed of a concurrent
OPRF and key exchange flow. The key exchange protocol is authenticated using the
client and server credentials established during registration; see {{offline-phase}}.
The type of keys MUST be suitable for the key exchange protocol. For example, if
the key exchange protocol is 3DH, as described in {{opaque-3dh}}, then the private and
public keys must be Diffie-Hellman keys. At the end, the client proves its
knowledge of the password, and both client and server agree on a mutually authenticated
shared secret key.

OPAQUE produces two outputs: a session secret and an export key. The export key may be used
for additional application-specific purposes, as outlined in {{export-key-usage}}.
The output `export_key` MUST NOT be used in any way before the HMAC value in the
envelope is validated. See {{envelope-encryption}} for more details about this requirement.

## Credential Retrieval

The online AKE stage of the protocol requires clients to obtain and decrypt their
credentials from the server-stored envelope. This process is similar to the offline
registration stage, as shown below.

~~~
 Client (password)             Server (server_private_key, server_public_key, credential_file)
 --------------------------------------------------------------------
 (request, blind) = CreateCredentialRequest(password)

                               request
                      ------------------------->

    response = CreateCredentialResponse(request, server_public_key, credential_file)

                               response
                      <-------------------------

 (client_private_key, server_public_key, export_key) =
     RecoverCredentials(password, blind, response)
~~~

The rest of this section describes these credential retrieval functions in
more detail.

### Credential Retrieval Messages

~~~
struct {
    SerializedElement data;
} CredentialRequest;
~~~

data
: A serialized OPRF group element.

~~~
struct {
    SerializedElement data;
    opaque server_public_key[Npk];
    Envelope envelope;
} CredentialResponse;
~~~

data
: A serialized OPRF group element.

server_public_key
: The server's encoded public key that will be used for the online authenticated
key exchange stage.

envelope
: The client's `Envelope` structure.

### Credential Retrieval Functions

#### CreateCredentialRequest {#create-credential-request}

~~~
CreateCredentialRequest(password)

Input:
- password, an opaque byte string containing the client's password

Output:
- request, a CredentialRequest structure
- blind, an OPRF scalar value

Steps:
1. (blind, M) = Blind(password)
2. Create CredentialRequest request with M
3. Output (request, blind)
~~~

#### CreateCredentialResponse {#create-credential-response}

~~~
CreateCredentialResponse(request, server_public_key, credential_file)

Input:
- request, a CredentialRequest structure
- server_public_key, the public key of the server
- credential_file, the server's output from registration
  (see {{credential-file}})

Output:
- response, a CredentialResponse structure

Steps:
1. Z = Evaluate(DeserializeScalar(credential_file.oprf_key), request.data)
2. Create CredentialResponse response
    with (Z, server_public_key, credential_file.envelope)
3. Output response
~~~

#### RecoverCredentials {#recover-credentials}

~~~
RecoverCredentials(password, blind, response)

Parameters:
- params, the MHF parameters established out of band
- Nh, the output size of the Hash function

Input:
- password, an opaque byte string containing the client's password
- blind, an OPRF scalar value
- response, a CredentialResponse structure

Output:
- client_private_key, the client's private key for the AKE protocol
- server_public_key, the public key of the server
- export_key, an additional key

Steps:
1. N = Unblind(blind, response.data)
2. y = Finalize(password, N, "OPAQUE")
3. contents = response.envelope.contents
4. envelope_nonce = contents.nonce
5. prk = HKDF-Extract(envelope_nonce, Harden(y, params))
6. pseudorandom_pad =
    HKDF-Expand(prk, "Pad", len(contents.encrypted_creds))
7. auth_key = HKDF-Expand(prk, "AuthKey", Nh)
8. export_key = HKDF-Expand(prk, "ExportKey", Nh)
9. Create CleartextCredentials cleartext_creds with response.server_public_key
   and custom identifiers creds.client_identity and creds.server_identity if mode is
   custom_identifier
10. expected_tag = HMAC(auth_key, concat(contents, cleartext_creds))
11. If !ct_equal(response.envelope.auth_tag, expected_tag),
    raise DecryptionError
12. secret_creds = xor(contents.encrypted_creds, pseudorandom_pad)
13. Output (secret_creds.client_private_key, response.server_public_key, export_key)
~~~

## AKE Instantiations {#instantiations}

This section describes instantiations of OPAQUE using 3-message AKEs which
satisfies the forward secrecy and KCI properties discussed in {{security-considerations}}.
As shown in {{OPAQUE}}, OPAQUE cannot use less than three messages so the 3-message
instantiations presented here are optimal in terms of number of messages. On the other
hand, there is no impediment of using OPAQUE with protocols with more than 3 messages
as in the case of IKEv2 (or the underlying SIGMA-R protocol {{SIGMA}}).

The generic outline of OPAQUE with a 3-message AKE protocol includes three messages
KE1, KE2, and KE3, where KE1 and KE2 include key exchange shares, e.g., DH values, sent
by client and server, respectively, and KE3 provides explicit client authentication and
full forward security (without it, forward secrecy is only achieved against eavesdroppers
which is insufficient for OPAQUE security).

The output of the authentication phase is a session secret `session_key` and export
key `export_key`. Applications can use `session_key` to derive additional keying material
as needed. Key derivation and other details of the protocol are specified by the AKE scheme.
We note that by the results in {{OPAQUE}}, KE2 and KE3 must authenticate credential_request
and credential_response, respectively, for binding between the underlying OPRF protocol
messages and the KE session.

We use the parameters Npk and Nsk to denote the size of the public and private keys used
in the AKE instantation. Npk and Nsk must adhere to the output size limitations of the
HKDF Expand function from {{RFC5869}}, which means that Npk, Nsk <= 255 * Nh.

The rest of this section includes key schedule utility functions used by OPAQUE-3DH,
and then provides a detailed specification for OPAQUE-3DH, including its wire format
messages.

### Key Schedule Utility Functions

The key derivation procedures for OPAQUE-3DH makes use of the functions below, re-purposed
from TLS 1.3 {{?RFC8446}}.

~~~
HKDF-Expand-Label(Secret, Label, Context, Length) =
  HKDF-Expand(Secret, HkdfLabel, Length)
~~~

Where HkdfLabel is specified as:

~~~
struct {
   uint16 length = Length;
   opaque label<8..255> = "OPAQUE " + Label;
   opaque context<0..255> = Context;
} HkdfLabel;

Derive-Secret(Secret, Label, Transcript-Hash) =
    HKDF-Expand-Label(Secret, Label, Transcript-Hash, Nh)
~~~

HKDF uses Hash as its underlying hash function, which is the same as that
which is indicated by the OPAQUE instantiation. Note that the Label parameter
is not a NULL-terminated string.

### OPAQUE-3DH Instantiation {#opaque-3dh}

OPAQUE-3DH is implemented using a suitable prime order group. All operations in
the key derivation steps in {{derive-3dh}} are performed in this group and
represented here using multiplicative notation. The output of OPAQUE-3DH is a
session secret `session_key` and export key `export_key`.

The parameters Npk and Nsk are set to be equal to the size of a scalar in the
associated prime order group.

#### OPAQUE-3DH Messages

The three messages for OPAQUE-3DH are described below.

~~~
struct {
  CredentialRequest request;
  uint8 client_nonce[32];
  opaque client_info<0..2^16-1>;
  uint8 client_keyshare[Npk];
} KE1;
~~~

request
: A `CredentialRequest` generated according to {{create-credential-request}}.

client_nonce
: A fresh 32-byte randomly generated nonce.

client_info
: Optional application-specific information to exchange during the protocol.

client_keyshare
: Client ephemeral key share of fixed size Npk, where Npk depends on the corresponding
prime order group.

~~~
struct {
  struct {
    CredentialResponse response;
    uint8 server_nonce[32];
    uint8 server_keyshare[Npk];
  } inner_ke2;
  opaque enc_server_info<0..2^16-1>;
  uint8 mac[Nh];
} KE2;
~~~

response
: A `CredentialResponse` generated according to {{create-credential-response}}.

server_nonce
: A fresh 32-byte randomly generated nonce.

server_keyshare
: Server ephemeral key share of fixed size Npk, where Npk depends on the corresponding
prime order group.

enc_server_info
: Optional application-specific information to exchange during the protocol encrypted
under key Ke2, defined below.

mac
: An authentication tag computed over the handshake transcript computed using Km2,
defined below.

~~~
struct {
  uint8 mac[Nh];
} KE3;
~~~

mac
: An authentication tag computed over the handshake transcript computed using
Km3, defined below.

#### OPAQUE-3DH Key Schedule {#derive-3dh}

OPAQUE-3DH requires MAC keys `server_mac_key` and `client_mac_key` and
encryption key `handshake_encrypt_key`. Additionally, OPAQUE-3DH also
outputs `session_key`. The schedule for computing this key material is below.

~~~
HKDF-Extract(salt=0, IKM)
    |
    +-> Derive-Secret(., "handshake secret", Hash(preamble)) = handshake_secret
    |
    +-> Derive-Secret(., "session secret", Hash(preamble)) = session_key
~~~

From `handshake_secret`, Km2, Km3, and Ke2 are computed as follows:

~~~
server_mac_key =
  HKDF-Expand-Label(handshake_secret, "server mac", "", Nh)
client_mac_key =
  HKDF-Expand-Label(handshake_secret, "client mac", "", Nh)
handshake_encrypt_key =
  HKDF-Expand-Label(handshake_secret, "handshake enc", "", Nh)
~~~

Nh is the output length of the underlying hash function.

The Derive-Secret parameter `preamble` is computed as:

~~~
preamble = concat("3DH",
                  I2OSP(len(client_identity), 2), client_identity,
                  KE1,
                  I2OSP(len(server_identity), 2), server_identity,
                  KE2.inner_ke2)
~~~

See {{identities}} for more information about identities client_identity and
server_identity.

Let `epkS` and `eskS` be `server_keyshare` and the corresponding secret key,
and `epkU` and `eskU` be `client_keyshare` and the corresponding secret key.
The input parameter `IKM` the concatenation of three DH values computed by
the client as follows:

~~~
IKM = concat(epkS^eskU, pkS^eskU, epkS^skU)
~~~

Likewise, `IKM` is computed by the server as follows:

~~~
IKM = concat(epkU^eskS, epkU^skS, pkU^eskS)
~~~

#### OPAQUE-3DH Encryption and Key Confirmation {#3dh-core}

Clients and servers use keys Km2 and Km3 in computing KE2.mac and KE3.mac,
respectively. These values are computed as follows:

- KE2.mac = HMAC(Km2, Hash(concat(preamble, KE2.enc_server_info)), where
  preamble is as defined in {{derive-3dh}}.
- KE3.mac = HMAC(Km3, Hash(concat(preamble, KE2.enc_server_info, KE2.mac)),
  where preamble is as defined in {{derive-3dh}}.

The server applicaton info, an opaque byte string `server_info`, is encrypted
using a technique similar to that used for secret credential encryption.
Specifically, a one-time-pad is derived from Ke2 and then used as input to XOR
with the plaintext. In pseudocode, this is done as follows:

~~~
info_pad = HKDF-Expand(Ke2, "encryption pad", len(server_info))
enc_server_info = xor(info_pad, server_info)
~~~

# Configurations {#configurations}

An OPAQUE configuration is a tuple (OPRF, Hash, MHF, EnvelopeMode, Group). The OPAQUE
OPRF protocol is drawn from the "base mode" variant of {{I-D.irtf-cfrg-voprf}}. The
following OPRF ciphersuites are supported:

- OPRF(ristretto255, SHA-512)
- OPRF(decaf448, SHA-512)
- OPRF(P-256, SHA-256)
- OPRF(P-384, SHA-512)
- OPRF(P-521, SHA-512)

Future configurations may specify different OPRF constructions.

The OPAQUE hash function is that which is associated with the OPRF ciphersuite.
For the ciphersuites specified here, only SHA-512 and SHA-256 are supported.

The OPAQUE MHFs include Argon2 {{?I-D.irtf-cfrg-argon2}}, scrypt {{?RFC7914}},
and PBKDF2 {{?RFC2898}} with fixed parameter choices.

The EnvelopeMode value is defined in {{credential-storage}}. It MUST be one
of `base` or `custom_identifier`. Future specifications may specify alternate
EnvelopeMode values and their corresponding Envelope structure.

The Group mode identifies the group used in the OPAQUE-3DH AKE. This SHOULD
match that of the OPRF.

# Security Considerations {#security-considerations}

OPAQUE is defined and proven as the composition of two
functionalities: an OPRF and an AKE protocol.
It can be seen as a "compiler" for transforming any AKE
protocol (with KCI security and forward secrecy - see below)
into a secure aPAKE protocol. In OPAQUE, the client stores a secret private key at the
server during password registration and retrieves this key each time
it needs to authenticate to the server. The OPRF security properties
ensure that only the correct password can unlock the private key
while at the same time avoiding potential offline guessing attacks.
This general composability property provides great flexibility and
enables a variety of OPAQUE instantiations, from optimized
performance to integration with TLS. The latter aspect is of prime
importance as the use of OPAQUE with TLS constitutes a major security
improvement relative to the standard password-over-TLS practice.
At the same time, the combination with TLS builds OPAQUE as a fully functional
secure communications protocol and can help provide privacy to
account information sent by the client to the server prior to authentication.

The KCI property required from AKE protocols for use with OPAQUE
states that knowledge of a party's private key does not allow an attacker
to impersonate others to that party. This is an important security
property achieved by most public-key based AKE protocols, including
protocols that use signatures or public key encryption for
authentication. It is also a property of many implicitly
authenticated protocols, e.g., HMQV, but not all of them. We also note that
key exchange protocols based on shared keys do not satisfy the KCI
requirement, hence they are not considered in the OPAQUE setting.
We note that KCI is needed to ensure a crucial property of OPAQUE: even upon
compromise of the server, the attacker cannot impersonate the client to the
server without first running an exhaustive dictionary attack.
Another essential requirement from AKE protocols for use in OPAQUE is to
provide forward secrecy (against active attackers).

## Related Analysis

Jarecki et al. {{OPAQUE}} proved the security of OPAQUE
in a strong aPAKE model that ensures security against pre-computation attacks
and is formulated in the Universal Composability (UC) framework {{Canetti01}}
under the random oracle model. This assumes security of the OPRF
function and of the underlying key exchange protocol. In turn, the
security of the OPRF protocol from {{I-D.irtf-cfrg-voprf}} is proven
in the random oracle model under the One-More Diffie-Hellman assumption {{JKKX16}}.

Very few aPAKE protocols have been proven formally, and those proven were analyzed
in a weak security model that allows for pre-computation attacks (e.g.,
{{GMR06}}). This is not just a formal issue: these protocols are
actually vulnerable to such attacks. This includes protocols that have recent
analyses in the UC model such as AuCPace {{AuCPace}} and SPAKE2+ {{SPAKE2plus}}.
We note that as shown in {{OPAQUE}}, these protocols, and any aPAKE
in the model from {{GMR06}}, can be converted into an aPAKE secure against
pre-computation attacks at the expense of an additional OPRF execution.

OPAQUE's design builds on a line of work initiated in the seminal
paper of Ford and Kaliski {{FK00}} and is based on the HPAKE protocol
of Xavier Boyen {{Boyen09}} and the (1,1)-PPSS protocol from Jarecki
et al. {{JKKX16}}. None of these papers considered security against
pre-computation attacks or presented a proof of aPAKE security
(not even in a weak model).

## Identities {#identities}

AKE protocols generate keys that need to be uniquely and verifiably bound to a pair
of identities. In the case of OPAQUE, those identities correspond to client_identity and server_identity.
Thus, it is essential for the parties to agree on such identities, including an
agreed bit representation of these identities as needed.

Applications may have different policies about how and when identities are
determined. A natural approach is to tie client_identity to the identity the server uses
to fetch envelope (hence determined during password registration) and to tie server_identity
to the server identity used by the client to initiate an offline password
registration or online authenticated key exchange session. server_identity and client_identity can also
be part of envelope or be tied to the parties' public keys. In principle, it is possible
that identities change across different sessions as long as there is a policy that
can establish if the identity is acceptable or not to the peer. However, we note
that the public keys of both the server and the client must always be those defined
at time of password registration.

The client identity (client_identity) and server identity (server_identity) are
optional parameters which are left to the application to designate as monikers for the client
and server. If the application layer does not supply values for these
parameters, then they will be omitted from the creation of the envelope
during the registration stage. Furthermore, they will be substituted with
client_identity = client_public_key and server_identity = server_public_key during
the authenticated key exchange stage.

The advantage to supplying a custom client_identity and server_identity (instead of simply relying
on a fallback to client_public_key and server_public_key) is that the client can then ensure that any
mappings between client_identity and client_public_key (and server_identity and server_public_key)
are protected by the authentication from the envelope. Then, the client can verify that the
client_identity and server_identity contained in its envelope matches the client_identity
and server_identity supplied by the server.

However, if this extra layer of verification is unnecessary for the application, then simply
leaving client_identity and server_identity unspecified (and using client_public_key and
server_public_key instead) is acceptable.

## Envelope Encryption {#envelope-encryption}

The analysis of OPAQUE from {{OPAQUE}} requires the authenticated encryption scheme
used to produce envelope to have a special property called random key-robustness
(or key-committing). This specification enforces this property by utilizing
encrypt-then-HMAC in the construction of envelope. There is no option to use another
authenticated-encryption scheme with this specification. (Deviating from the
key-robustness requirement may open the protocol to attacks, e.g., {{LGR20}}.)
We remark that export_key for authentication or encryption requires no special
properties from the authentication or encryption schemes as long as export_key
is used only after the envelope is validated, i.e., after the HMAC in RecoverCredentials
passes verification.

## Export Key Usage {#export-key-usage}

The export key can be used (separately from the OPAQUE protocol) to provide
confidentiality and integrity to other data which only the client should be
able to process. For instance, if the server is expected to maintain any
client-side secrets which require a password to access, then this export key
can be used to encrypt these secrets so that they remain hidden from the
server.

## Static Diffie-Hellman Oracles

While one can expect the practical security of the OPRF function (namely,
the hardness of computing the function without knowing the key) to be in the
order of computing discrete logarithms or solving Diffie-Hellman, Brown and
Gallant {{BG04}} and Cheon {{Cheon06}} show an attack that slightly improves
on generic attacks. For typical curves, the attack requires an infeasible
number of calls to the OPRF or results in insignificant security loss;
see {{I-D.irtf-cfrg-voprf}} for more information. For OPAQUE, these attacks
are particularly impractical as they translate into an infeasible number of
failed authentication attempts directed at individual users.

## Input Validation {#validation}

Both client and server MUST validate the other party's public key(s) used
for the execution of OPAQUE. This includes the keys shared during the
offline registration phase, as well as any keys shared during the online
key agreement phase. The validation procedure varies depending on the
type of key. For example, for OPAQUE instantiations
using 3DH with P-256, P-384, or P-521 as the underlying group, validation
is as specified in Section 5.6.2.3.4 of {{keyagreement}}. This includes
checking that the coordinates are in the correct range, that the point
is on the curve, and that the point is not the point at infinity.
Additionally, validation MUST ensure the Diffie-Hellman shared secret is
not the point at infinity.

## OPRF Hardening

Hardening the output of the OPRF greatly increases the cost of an offline
attack upon the compromise of the password file at the server. Applications
SHOULD select parameters that balance cost and complexity.

<!-- TODO(caw): bring this back after updating later -->

<!-- ## Envelope considerations

It is possible to dispense with encryption in the construction of envelope to
obtain a shorter envelope (resulting in less storage at the server and less
communication from server to client). The idea is to derive client_private_key from prk.
However, for cases where client_private_key is not a random string of a given length, we
define a more general procedure. Namely, what is derived from prk is a random
seed used as an input to a key generation procedure that generates the pair
(client_private_key, client_public_key). In this case, secret_credentials is empty and cleartext_credentials
contains server_public_key. The random key generation seed is defined as
HKDF-Expand(KdKey; info="KG seed", L)
where L is the required seed length. We note that in this encryption-less
scheme, the authentication still needs to be random-key robust which HMAC
satisfies. -->

<!--
Mention advantage of avoidable equivocable encryption? Still needs equivocable
authentication, but that one gets by modeling HMAC as programmable RO - check.
-->

<!-- To further minimize storage space, the server can derive per-client OPRF keys
oprf_key from a single global secret key, and it can use the same pair
(server_private_key,server_public_key) for all clients. In this case, the per-client OPAQUE storage
consists of client_public_key and HMAC(Khmac; server_public_key), a total of 64-byte overhead with a
256-bit curve and hash. envelope communicated to the client is of the same length,
consisting of server_public_key and HMAC(Khmac; server_public_key). -->

<!-- Can provide AuCPace paper (sec 7.7) as reference to importance of small
envelope (for settings where storage and/or communication is expensive) -->

## Client Enumeration {#SecEnumeration}

Client enumeration refers to attacks where the attacker tries to learn
whether a given client identity is registered with a server. Preventing
such attacks requires the server to act with unknown client identities
in a way that is indistinguishable from its behavior with existing
clients. Here we suggest a way to implement such defense, namely, a way for
simulating a CredentialResponse for non-existing clients.
Note that if the same CredentialRequest is received
twice by the server, the response needs to be the same in both cases (since
this would be the case for real clients).
For protection against this attack, one would apply the encryption function in
the construction of envelope to all the key material in envelope.
The server S will have two keys MK, MK' for a pseudorandom function f.
f refers to a regular pseudorandom function such as HMAC or CMAC.
Upon receiving a CredentialRequest for a non-existing
client client_identity, S computes oprf_key=f(MK; client_identity) and oprf_key'=f(MK'; client_identity) and responds with
CredentialResponse carrying Z=M^oprf_key and envelope, where the latter is computed as follows.
prk is set to oprf_key' and secret_creds is set to the all-zero string (of the
length of a regular envelope plaintext). Care needs to be taken to avoid side
channel leakage (e.g., timing) from helping differentiate these
operations from a regular server response.
The above requires changes to the server-side implementation but not to the
protocol itself or the client side.

There is one form of leakage that the above allows and whose prevention would
require a change in OPAQUE.
An attacker that attempts authentication with the same CredentialRequest twice and receives
different responses can conclude that either the client registered with the
service between these two activations or that the client was registered before
but changed its password in between the activations (assuming the server
changes oprf_key at the time of a password change). In any case, this
indicates that client_identity is a registered client at the time of the second activation.
To conceal this information, S can implement the derivation of oprf_key
as oprf_key=f(MK; client_identity) also for registered clients. Hiding changes in envelope, however,
requires a change in the protocol. Instead of sending envelope as is,
S would send an encryption of envelope under a key that the client derives from the
OPRF result (similarly to prk) and that S stores during password
registration. During the authenticated key exchange stage, the client will derive
this key from the OPRF result, will use it to decrypt envelope, and continue with the
regular protocol. If S uses a randomized encryption, the encrypted envelope will look
each time as a fresh random string, hence S can simulate the encrypted envelope also
for non-existing clients.

Note that the first case above does not change the protocol so its
implementation is a server's decision (the client side is not changed).
The second case, requires changes on the client side so it changes OPAQUE
itself.

[[https://github.com/cfrg/draft-irtf-cfrg-opaque/issues/22: Should this variant be documented/standardized?]]

## Password Salt and Storage Implications

In OPAQUE, the OPRF key acts as the secret salt value that ensures the infeasibility
of pre-computation attacks. No extra salt value is needed. Also, clients never
disclose their password to the server, even during registration. Note that a corrupted
server can run an exhaustive offline dictionary attack to validate guesses for the client's
password; this is inevitable in any aPAKE protocol. (OPAQUE enables a defense against such
offline dictionary attacks by distributing the server so that an offline attack is only
possible if all - or a minimal number of - servers are compromised {{OPAQUE}}.)

Some applications may require learning the client's password for enforcing password
rules. Doing so invalidates this important security property of OPAQUE and is
NOT RECOMMENDED. Applications should move such checks to the client. Note that
limited checks at the server are possible to implement, e.g., detecting repeated
passwords.

# IANA Considerations

This document makes no IANA requests.

--- back

# Acknowledgments

The OPAQUE protocol and its analysis is joint work of the author with Stas
Jarecki and Jiayu Xu. We are indebted to the OPAQUE reviewers during CFRG's
aPAKE selection process, particularly Julia Hesse and Bjorn Tackmann.
This draft has benefited from comments by multiple people. Special thanks
to Richard Barnes, Dan Brown, Eric Crockett, Paul Grubbs, Fredrik Kuivinen,
Payman Mohassel, Jason Resch, Greg Rubin, and Nick Sullivan.

# Alternate AKE Instantiations {#alternate-akes}

It is possible to instantiate OPAQUE with other AKEs, such as HMQV {{HMQV}} and SIGMA-I.
HMQV is similar to 3DH but varies in its key schedule. SIGMA-I uses digital signatures
rather than static DH keys for authentication. Specification of these instantiations is
left to future documents. A sketch of how these instantiations might change is included
in the next subsection for posterity.

The AKE private key size (Nsk) is limited to the output size of the HKDF Expand function
from {{RFC5869}}.  Future specifications which have keys exceeding this size should
specify a mechanism by which private keys and their corresponding public keys can be
deterministically derived from a fixed-length seed.

OPAQUE may also be instantiated with any post-quantum (PQ) AKE protocol that has the message
flow above and security properties (KCI resistance and forward secrecy) outlined
in {{security-considerations}}. Note that such an instantiation is not quantum safe unless
the OPRF is quantum safe. However, an OPAQUE instantiation where the AKE is quantum safe,
but the OPRF is not, would still ensure the confidentiality of application data encrypted
under session_key (or a key derived from it) with a quantum-safe encryption function.

## HMQV Instantiation Sketch

An HMQV instantiation would work similar to OPAQUE-3DH, differing primarily in the key
schedule {{HMQV}}. First, the key schedule `preamble` value would use a different constant prefix
-- "HMQV" instead of "3DH" -- as shown below.

~~~
preamble = concat("HMQV",
                  I2OSP(len(client_identity), 2), client_identity,
                  KE1,
                  I2OSP(len(server_identity), 2), server_identity,
                  KE2.inner_ke2)
~~~

Second, the IKM derivation would change. Assuming HMQV is instantiated with a cyclic
group of prime order p with bit length L, clients would compute `IKM` as follows:

~~~
u' = (eskU + u \* skU) mod p
IKM = (epkS \* pkS^s)^u'
~~~

Likewise, servers would compute `IKM` as follows:

~~~
s' = (eskS + s \* skS) mod p
IKM = (epkU \* pkU^u)^s'
~~~

In both cases, `u` would be computed as follows:

~~~
hashInput = concat(I2OSP(len(epkU), 2), epkU,
                   I2OSP(len(info), 2), info,
                   I2OSP(len("client"), 2), "client")
u = Hash(hashInput) mod L
~~~

Likewise, `s` would be computed as follows:

~~~
hashInput = concat(I2OSP(len(epkS), 2), epkS,
                   I2OSP(len(info), 2), info,
                   I2OSP(len("server"), 2), "server")
s = Hash(hashInput) mod L
~~~

Hash is the same hash function used in the main OPAQUE protocol for key derivation.
Its output length (in bits) must be at least L.

## SIGMA-I Instantiation Sketch

A SIGMA-I instantiation differs more drastically from OPAQUE-3DH, since authentication
uses digital signatures in lieu of Diffie Hellman. In particular, both KE2 and KE3
would carry a digital signature, computed using the server and client private keys
established during registration, respectively, as well as a MAC, where the MAC is
computed as in OPAQUE-3DH.

The key schedule would also change. Specifically, the key schedule `preamble` value would
use a different constant prefix -- "SIGMA-I" instead of "3DH" -- and the `IKM` computation
would use only the ephemeral key shares exchanged between client and server.

# Test Vectors

This section contains test vectors for the OPAQUE-3DH specification. Each test
vector specifies the configuration information, protocol inputs, intermeidate
values computed during registration and authentication, and protocol outputs.
All values are encoded in hexadecimal strings. The configuration information
includes the (OPRF, Hash, MHF, EnvelopeMode, Group) tuple, where the Group
matches that which is used in the OPRF.

## OPAQUE-3DH Test Vector 1

### Configuration

~~~
OPRF: 0001
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 01
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
~~~

### Input Values

~~~
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 8dee75c66f14d8b891c6ba66f1ff8d27ab595186789ca5edf46dd
427b6effb95
client_private_key: 8bcb0b70dac18de24eef12e737d6b28724d3e37774e0b092f
9f70b255defaf04
client_public_key: 360e716c676cfe4d9968d1a352ed3faf17603863e0a7aa1905
df6ea129343b09
server_private_key: f3a0829898a89239dce29ccc98ec8b449a34b255ba1e6f944
829d18e0d589b0f
server_public_key: 66e130c6eb5b41f851b235b03a0eafeaa883f64147bc62cb74
9c22c762389c3c
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 1b42bc94d7f3844a0a284d377fbbe2bdef574d386c9f8b5ead7b7e1
5b151b939
client_nonce: 4b6737c0bb603516ffaad7af55446a4d179187eba9e1b987aabe2be
05397b701
server_keyshare: 5214e3ddc73db786480b79fa2da787f2080b82cbe922c2a9592b
44597d9a702e
client_keyshare: a4084c7296b1a3d5a5e4a24358750489575acfd8fcfa6e787492
b98265a5e651
server_private_keyshare: c4d002aa4cfcf281657cf36fe562bc60d9133e0e72a7
4432f685b2b6a4b42a0c
client_private_keyshare: de2e98f422bf7b99be19f7da7cac62f1599d35a225ec
6340149a0aaff3102003
blind_registration: 7e5bcbf82a46109ee0d24e9bcab41fc830a6ce8b82fc1e921
3a043b743b95800
blind_login: c4d5a15f0d5ffc354e340454ec779f575e4573a3886ab5e57e4da298
4bdd5306
oprf_key: 080d0a4d352de92672ab709b1ae1888cb48dfabc2d6ca5b914b335512fe
70508
~~~

### Intermediate Values

~~~
auth_key: 89f76086c4a22a1f9d6c0ab4c7f5b2b4602d756267f8ba7a27aaac1c624
8ec621e16e7935af1b1fa38ca0c389b8e563b8c7e0daa6cfbbc2ad53ea40e006ac243
prk: 159cb43f6d84d9423771010ff0223015870856ac20601876d6d02a9298bd7ec0
ef656d6537420e5d26d768454089389618c6f52c5865c855f2b2684c33c2a225
pseudorandom_pad: dc07da9e15679d4defb299284a029be4878469c905071f2b3d7
08de16c0b1f6e
envelope: 018dee75c66f14d8b891c6ba66f1ff8d27ab595186789ca5edf46dd427b
6effb95002057ccd1eecfa610afa15d8bcf7dd42963a3578abe71e7afb9c48786c431
e4b06ac6906d20d50ea18fe30a05152ac17f34d49cb00567f1cc37d2c7951e00a6c3b
dec25eed743d642c859f48425ecfd695ea27ffe9ee7df6232a8e0bf0b30c774bc
handshake_secret: c7c26c98fe5b164538ce0991e6dc2a3d7e50f78ee4ffac5dc66
48252fc43e10d3574040202417a2199d20841352ec63a25d22dd4e1f33630f2a02836
a9c6f0ce
handshake_encrypt_key: acb381928b2928e92b8780a7ab446e81f1b39545a1a287
bc33693882c5bb202cca4418aa416d955a2309f7663656c48fe63a261c62afa6fbd76
90b031e6d6cc5
server_mac_key: 4f45b1d86815c029d3bca5bf453d693f12bee45a0a71014ab0873
0939eb529ab2b532275887aaa6853866e1fe8ae67a34d555c94726128beb37f4debd9
009407
client_mac_key: ce95ecfcbed2348997e4ef4f232e8448e94f7bfefb9b135a12390
05963c2b6a415a760cb85b44df0da423e32d110e00c42251cb6e7cb19c512a17e28ad
bc6fa3
~~~

### Output Values

~~~
registration_request: ec9027daa5e9a901d641286a7ded51364142936ac7636e1
42e3f4368b4bd8124
registration_response: 8867d7c8c2c576a6322d49d46078ea32f479aed917c70a
636d3ada4397ea1c0e66e130c6eb5b41f851b235b03a0eafeaa883f64147bc62cb749
c22c762389c3c
registration_upload: 360e716c676cfe4d9968d1a352ed3faf17603863e0a7aa19
05df6ea129343b09018dee75c66f14d8b891c6ba66f1ff8d27ab595186789ca5edf46
dd427b6effb95002057ccd1eecfa610afa15d8bcf7dd42963a3578abe71e7afb9c487
86c431e4b06ac6906d20d50ea18fe30a05152ac17f34d49cb00567f1cc37d2c7951e0
0a6c3bdec25eed743d642c859f48425ecfd695ea27ffe9ee7df6232a8e0bf0b30c774
bc
KE1: e06a32011e1b1704eb686b263e5d132fff4e9f6429cd93b98db107485006792c
4b6737c0bb603516ffaad7af55446a4d179187eba9e1b987aabe2be05397b70100096
8656c6c6f20626f62a4084c7296b1a3d5a5e4a24358750489575acfd8fcfa6e787492
b98265a5e651
KE2: 66f6b5fa1a4eb6bd7a0c93ed2639a31cba0d02e2df744003641d5a30a4a12364
66e130c6eb5b41f851b235b03a0eafeaa883f64147bc62cb749c22c762389c3c018de
e75c66f14d8b891c6ba66f1ff8d27ab595186789ca5edf46dd427b6effb95002057cc
d1eecfa610afa15d8bcf7dd42963a3578abe71e7afb9c48786c431e4b06ac6906d20d
50ea18fe30a05152ac17f34d49cb00567f1cc37d2c7951e00a6c3bdec25eed743d642
c859f48425ecfd695ea27ffe9ee7df6232a8e0bf0b30c774bc1b42bc94d7f3844a0a2
84d377fbbe2bdef574d386c9f8b5ead7b7e15b151b9395214e3ddc73db786480b79fa
2da787f2080b82cbe922c2a9592b44597d9a702e000ff048b3a462ab243936a4ef2de
87dd0bcd3e7d7f12004b59dc8edeff2885f9dbafa60a55d1d31397b0dd25944ea8b63
842d77720aec60e0708b24cc9a311d424f3880b3ac84a68adc7b5947d5266ec5
KE3: 17ace8fa7c3956f1ea6684fae1bae259e0d8d78214b235e8646904576c17fc43
b7a8eeb6b21b8ee94a31cc075717e8c0b25e8803837238055236ae908010a8e3
export_key: 13af620bbf9cf45da6d4223500d2a9c79b28478d7548cfd52e3708ffc
4d9ddffa9c7735e1958751efbd68c79df6c451ccc48b41dda1748b585c2b5fd7d7f82
64
session_key: 0b51348833b30bfeceab9d13888111c2fcf9c93b6689e1d6c601a26c
a29aa25e19949955ec7d056fce67c24d0fb1b53ea47e27e7966fc267379c3d0c9a738
f54
~~~

## OPAQUE-3DH Test Vector 2

### Configuration

~~~
OPRF: 0002
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 01
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
~~~

### Input Values

~~~
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 8f0f2ef8d159e031c6cb8ab7018caf6a3a6fb9b6220ca48b5bfc1
ebdd1079384
client_private_key: 614bb578f29cc677ea9e7aea3e4839413997e020f9377b63c
13584156a09a46dd2a425c41eac0e313a47e99d05df72c6e1d58e6592577a0d
client_public_key: a8f6d7dad9ec587964d6dffb1b63f951dc30a934137eb42057
f390d593dfafb6a687ec5c3ad3c35bb6a71338dc8106bd53b3a4fcec6110a1
server_private_key: 4c115060bca87db7d73e00cbb8559f84cb7a221b235b0950a
0ab553f03f10e1386abe954011b7da62bb6599418ef90b5d4ea98cc28aff517
server_public_key: bc66494bf44cdfed66f6b4c482a18e00a3d16a09d11775064f
963cc7bae3b6592a6b03fb982f5b5676972005a29d1dcfd46b6986088ca9d4
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: ed48df93a9cec17e7e47b3d8ff328082a03743ea58c666b99e8e63b
e0a362b0e
client_nonce: 709cb9231bc5d7e289c21fc79b33b1f45d2828b776b1034429fbce0
0c2854732
server_keyshare: 5472ca0fc98d652ded1ba4edc7d876a791b2c2a61c1201ffe354
8e0f3a1d479e1629a35a7f910ef27f46c93ade70ee4cbdf9a2183f6d0754
client_keyshare: 46770873fdab1e43177a9f1b2d127a44e0b4c2becf3ac4545248
ef410d143cce32f76df27f47cf19347b42e3cd1f9432cda204701e188c32
server_private_keyshare: 0676f161ab555182908dbd7947b1c988956fa73b17b3
73b72fd4e3c0264a26aa4cab20fd864de6ceab345e8d755997956ddd1f265e8be105
client_private_keyshare: d0f08ac99ef2ab5b26fa7b2a6d920c76cf03fb57bdea
cc2ec39330fd6e7f9e5dbdfcb571168f337dd52851d4bc07947c858dc735bab8ca2b
blind_registration: a614f1894bcf6a1c7cef33909b794fe6e69a642b20f4c9118
febffaf6b6a31471fe7794aa77ced123f07e56cc27de60b0ab106c0b8eab127
blind_login: 668b3aab5207735beb86c5379228da260159dc24f7c5c2483a81aff8
d9ff676ebd81db28eb1e147561c478a3f84cbf77037f01025c7fd42a
oprf_key: 93dd2d051e90efe4e2e093bc1e82b80e8cce6afa798ac214abffabac2a2
58015d93e9faf0f2009d16c797646097d761e2b84e0df971d7b39
~~~

### Intermediate Values

~~~
auth_key: 4e2200047fbeec5519d2c4c40b33f71325e019e16080e69b2242b71d1fe
1f524d59dff76caacc6235fbd2afb32c4eaecfea1458240633c461ef24da6af3b54dc
prk: 61e1fc21f4dfb61d28a0edaf7b55d8f6dd9b1f9ceb7982bcf4e060a6f4d6a3f6
7859e4943f9b4ccfbf4ff92bde335c19824dc94da164bc2049965e9047cd25d3
pseudorandom_pad: 2bec1c3927d9999c266569359d519ec04ca2f6118762b0e05b3
b1515932bfdaf212ebcefc8dc4b72f012198c9983b1817d41e1480d5ec4de
envelope: 018f0f2ef8d159e031c6cb8ab7018caf6a3a6fb9b6220ca48b5bfc1ebdd
107938400384aa7a941d5455febccfb13dfa319a781753516317e55cb839a0e9100f9
2259c2f38a992bd6704543ca55f0119c5cc3479c946f2d9f09bed3d4af42c6114a866
eb705e8482a19c36f9937d0e679c221d729fe9c50194696bab0e41358bfbae20460e6
f6b0bb41a40fe5aa1349fa0eab4ed1f55d456bd1bf63
handshake_secret: f26ed477133b665d012dc2f778b17f7a1b2df0060bc342b9b22
bff2d986b812a3a1ae48ee3c5dcb4a2e3f822e5ce2de2b5460828e3fff22c66403fe1
a56ec91f
handshake_encrypt_key: a42861051af86be482dca04e62d10d1271952e38379c3d
2ff1314e21f7c4da07688b7f89ce2d69542c064f9f9a78f81e9eb3c7da2418ae53428
45930bd486cc4
server_mac_key: c5a10392c7df1c1b630ccf627bcd1f78425d08a6e79201d998fca
f371816e82d1d3b4590809060674ffb6a88a3002bdb37201c133a097497e77678f7fd
5824e8
client_mac_key: 07fa131afbb25ff33e2af5a37dbf74afc0e90e6c4f61f3bd29f4e
d4d51af215fa24122061d08b474f47cb0a215a87c0657ed76937c36120b9803371c1d
dd1778
~~~

### Output Values

~~~
registration_request: d21b318acf1b255d0f009bf3cb24b7b2f88cb58880775b8
dff43a81ab49fe73f0356b70ff3e5c251bc9810767c98491d8187d2cf11dff618
registration_response: c023432da8f17d6e5e740d9d1a0fb55dbc8e1830bd72ec
2e1f59da065858170b05c1f711ca085d8cf5a52ae1ea5198196bd9907dca045c6fbc6
6494bf44cdfed66f6b4c482a18e00a3d16a09d11775064f963cc7bae3b6592a6b03fb
982f5b5676972005a29d1dcfd46b6986088ca9d4
registration_upload: a8f6d7dad9ec587964d6dffb1b63f951dc30a934137eb420
57f390d593dfafb6a687ec5c3ad3c35bb6a71338dc8106bd53b3a4fcec6110a1018f0
f2ef8d159e031c6cb8ab7018caf6a3a6fb9b6220ca48b5bfc1ebdd107938400384aa7
a941d5455febccfb13dfa319a781753516317e55cb839a0e9100f92259c2f38a992bd
6704543ca55f0119c5cc3479c946f2d9f09bed3d4af42c6114a866eb705e8482a19c3
6f9937d0e679c221d729fe9c50194696bab0e41358bfbae20460e6f6b0bb41a40fe5a
a1349fa0eab4ed1f55d456bd1bf63
KE1: 30a31f471b8adc9e3fcb796a6ee1ee97edabf6a77468c58621a0cfaecee3c1ac
1a1dbe16a0fbf6fc4d2f882d8431303bded7a16d207f840c709cb9231bc5d7e289c21
fc79b33b1f45d2828b776b1034429fbce00c2854732000968656c6c6f20626f624677
0873fdab1e43177a9f1b2d127a44e0b4c2becf3ac4545248ef410d143cce32f76df27
f47cf19347b42e3cd1f9432cda204701e188c32
KE2: 2453710eb7a3226bfedb501efe06772d9450aa9ba9eed8adddd931964364e3d3
d5d2a22822f0d85569fa396b8e9c6657ff5115dbd4c0a218bc66494bf44cdfed66f6b
4c482a18e00a3d16a09d11775064f963cc7bae3b6592a6b03fb982f5b5676972005a2
9d1dcfd46b6986088ca9d4018f0f2ef8d159e031c6cb8ab7018caf6a3a6fb9b6220ca
48b5bfc1ebdd107938400384aa7a941d5455febccfb13dfa319a781753516317e55cb
839a0e9100f92259c2f38a992bd6704543ca55f0119c5cc3479c946f2d9f09bed3d4a
f42c6114a866eb705e8482a19c36f9937d0e679c221d729fe9c50194696bab0e41358
bfbae20460e6f6b0bb41a40fe5aa1349fa0eab4ed1f55d456bd1bf63ed48df93a9cec
17e7e47b3d8ff328082a03743ea58c666b99e8e63be0a362b0e5472ca0fc98d652ded
1ba4edc7d876a791b2c2a61c1201ffe3548e0f3a1d479e1629a35a7f910ef27f46c93
ade70ee4cbdf9a2183f6d0754000fdf53ca1a7716e7d7eab32275e9a45f2d4f1cced9
6dfc3356838c759be2af4338c16b24bd9e11bc1f4c609bed2ef8131253ceb509274a8
106577d63cfdb30d707e841f8aa7e1e184bc67b2186ef3c8d
KE3: 942184d6d21506be1dd66fb653353ca8464773b8da263ac1530f903c61390fd2
5de89fdc8e19876e54be6217d608cd8371be8744210347c082d72d30233713b6
export_key: 50812f323be608a74a329d39e0a55832132fde549726eb0033fb93d4a
16276b16ef67871520c9cabe991b78c542d7c06fa9159faebf7e284df6dedb78409dd
f6
session_key: a2416256ee5ff2216464c8646b8f392e5582190fcc87445de033a0d6
da332f29c60582e5e0f850571643c5a51725179c8df4b162b1fc33d90acf3bbb05058
4f4
~~~

## OPAQUE-3DH Test Vector 3

### Configuration

~~~
OPRF: 0003
Hash: SHA256
SlowHash: Identity
EnvelopeMode: 01
Group: P-256
Nh: 32
Npk: 33
Nsk: 32
~~~

### Input Values

~~~
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 1a18b0428b8c94864e498a623e1ede6dcea44fcb4b77f0b8a996d
a58ea3bcf22
client_private_key: 67b5bcebad6393e2d0b7db3d2b4597a670a5204b2b606f5a2
8328916e1e5ea5b
client_public_key: 030e2b9005157dfd740a13c9525a2132512a463927174d9728
0f80f962d1a650e3
server_private_key: fc2e715b2db1e7a3ad4ff8af1b24daa1922d13757ac9df4ad
c7e4e0b6b399433
server_public_key: 03ca5ebe2c9b87ff1e76e2e72f8a59273fe5c9688fee7dd2f2
8964187a0940c397
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 9fed4758f99070b587eae08389ce4aeb64a3372780249037214059e
deaf36068
client_nonce: 6ae0b0c78c8a85457f21255600facedd0e256add336e33cc0142e9c
71aac315e
server_keyshare: 03a716d72106b7ad668ae097e553a46f4dd96961816fbe8e2243
43a7f0ab95a05a
client_keyshare: 037086638b1beb10b9a6a44ea0ee5b369081004df36cba0c16c8
d485482de57ff6
server_private_keyshare: a6532c99c1ea3f03d05f6e78dc1edabd3b9631be9f8b
274d9aaf671bfb6a7753
client_private_keyshare: 29bf435021b89c683259773bc686956af0c7822ba317
fb5e86028c44b92bd3af
blind_registration: 3e7c5057e09e220065ea8c257c0dd6055c4b401063eff0bf2
42b4cd534a79bad
blind_login: dcf6744d388ca013ef33edd369304ed96fc56c7c6c0bd369f8e926ff
e4854a59
oprf_key: f6b3e908bdb38e3c626a939e19daca653b9217801b5d51cef66d9fdbd94
a5354
~~~

### Intermediate Values

~~~
auth_key: 9928b3595ae1b9db82799d83c32e3488d97de004867f1420381d773c897
a37ba
prk: 66ef435e3d3ad16685148597176965a0f82238bdba9fc26e4ee63daed2ee51ae
pseudorandom_pad: 57ca06847558e97fe4d9fa0a17312a94d1b3a02431500221611
a270fddcf0689
envelope: 011a18b0428b8c94864e498a623e1ede6dcea44fcb4b77f0b8a996da58e
a3bcf220020307fba6fd83b7a9d346e21373c74bd32a116806f1a306d7b4928ae193c
2aecd2ad2af344c9a501b477a38d2a08755f4242b078fad38dbf34182dda9ac6f675d
d
handshake_secret: 5f76c1e3645d8867e39bcd3b6a54c186f5323175f91232a3794
850a55c66c66a
handshake_encrypt_key: 5e9f9904d078eb4984642e6dfe712243c736ae1661d5a4
0be39ad6602c915f90
server_mac_key: dbfd215268ecce41c1dbabd9af5bb39f8e07232ec24b1d77f4c2a
dcf567dfb79
client_mac_key: 5f592b2a3c1a9676e98fe80b4c62cafe351d4b6f51f1b08c1496d
815dbc224c9
~~~

### Output Values

~~~
registration_request: 0295067c743d15a0a9d4c6c15511b67e3858e9e22f8c44a
0c1de6e33cda494024b
registration_response: 02465cd175b404fc1426b3b9518a79ee219007679909f4
59f92cfc89929c89458e03ca5ebe2c9b87ff1e76e2e72f8a59273fe5c9688fee7dd2f
28964187a0940c397
registration_upload: 030e2b9005157dfd740a13c9525a2132512a463927174d97
280f80f962d1a650e3011a18b0428b8c94864e498a623e1ede6dcea44fcb4b77f0b8a
996da58ea3bcf220020307fba6fd83b7a9d346e21373c74bd32a116806f1a306d7b49
28ae193c2aecd2ad2af344c9a501b477a38d2a08755f4242b078fad38dbf34182dda9
ac6f675dd
KE1: 0230e8f9b3689b65b952bf044702673c4d5278119b25d3833a3de655b9289f89
e16ae0b0c78c8a85457f21255600facedd0e256add336e33cc0142e9c71aac315e000
968656c6c6f20626f62037086638b1beb10b9a6a44ea0ee5b369081004df36cba0c16
c8d485482de57ff6
KE2: 025c6387cee347fa24a57c7021890ee13f435ea5e92b20fb488c3984e060ad4d
6f03ca5ebe2c9b87ff1e76e2e72f8a59273fe5c9688fee7dd2f28964187a0940c3970
11a18b0428b8c94864e498a623e1ede6dcea44fcb4b77f0b8a996da58ea3bcf220020
307fba6fd83b7a9d346e21373c74bd32a116806f1a306d7b4928ae193c2aecd2ad2af
344c9a501b477a38d2a08755f4242b078fad38dbf34182dda9ac6f675dd9fed4758f9
9070b587eae08389ce4aeb64a3372780249037214059edeaf3606803a716d72106b7a
d668ae097e553a46f4dd96961816fbe8e224343a7f0ab95a05a000f8569326cfb0938
175b258c2744f2f4e999b75f2779dbc8c43dc1bc7fe6a2c33d5ed40f5b0a8d31b3054
802f879456d
KE3: 3702499f9f1ca39468242b9bc4f33fd497824a0e32b5cabab198d382b215ffee
export_key: e2babe48e3fb059fc4ac51926a2cfe73129a35b08392df993022401c6
e7223d8
session_key: c44dcf0f6701e611d29f44a4360bd6ccdbe8970653adb864a090491c
72c2c4a7
~~~

## OPAQUE-3DH Test Vector 4

### Configuration

~~~
OPRF: 0004
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 01
Group: P-384
Nh: 64
Npk: 49
Nsk: 48
~~~

### Input Values

~~~
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 6b1e580724f42d3476771d0840f2706d7e503ba4cf7d07bdebe0b
315eff00944
client_private_key: f3cfa0420080cbff2e3431bcc25f80b409c533dd21924d77b
cbd10873989b7e58306b863276ae74049615162a416d508
client_public_key: 02c86369d6eae0978bdd4030b43e0619ce46ea9d91fa6e0e75
75bb12aa4857db98b952d8af9d92f75899c49d0d18793c1e
server_private_key: 2902c13bdc9993d3717bda68fc080b9802ae4effd5dc972d9
f9fb3bbbf106add174393effaf0a175fa8e85f898568620
server_public_key: 0251f78cbd5c7a3fbf4cdaeb755eb8cc4159edb0ef38baebb5
03dbefed5c89c14f7c2b99ed242b3d1de890f7515bad94bd
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 7eff21eb659aa360da7469e5fcafc9257ed13c43cc4cf2e9137653c
348a8ccdd
client_nonce: e3c133d95b8eacd5551d9f97a5342cadcaed43ce4156c5bb3a1d23f
063e9c428
server_keyshare: 035684e8cdae6ce360c2d3f41e4b059f34f986e92dd50c8255f7
d7dc0c16252ef9b8c9fb9e0c2846053355e7fcfa46781f
client_keyshare: 027044d31354b5b98587d7d144526f6c8528317cc3e9675c90a1
952f4bc2725a6a154f59aed10e4ff7ec68d4917d74122b
server_private_keyshare: 3e3869237f74106241777f230582e849076f08753056
c186437ded8ee22f96e44bd5b6ec07cb131d51cf1324c1238699
client_private_keyshare: 59b596174a682828f3934d510217ce7890f67cafc0ff
aa7a1e1d1ced3c477fea691e696032c8709c86cbcda2b184ad01
blind_registration: 3382c7ec9bdd6e75898e4877d8e2bc16359073c015b92d154
50f7fb395bf52c6ea98384c491fe4e4d423b59de7b0df39
blind_login: 29d29abeabede9788d11782429bff296102f6338df84c9602bfa9e7d
690b1f7a173d07e6d54a419db4a6308f8b09589f
oprf_key: 4283efb9cd1ee4061c6bf884e60a877321ece4f9b6ffd01ce8208254541
3bd9bb5e8f3c63b86ae88d9ce0530b01cb1c3
~~~

### Intermediate Values

~~~
auth_key: 86a0370a2501312e8b5c198d2b97a7e896147dfad93f7471eb26ee048aa
96c83678dd4c126bb3ee8d53644ddef276f6c65e6674ab08de269038ad7cacbf19dc7
prk: cb990214850554d986ded7e8a95656e98d84e9f6812f1d3f397eda4eadca385c
9830725bf36d491aed7b0ec56fb6d7c51f7ab04b6300e7dac98d350a6ad75266
pseudorandom_pad: 3b5f2915916bf37baec3e7a355a484e68c79baeab8cab9713ad
51892bf8b3048459f629b1d5514ebd49a9b414af457bf
envelope: 016b1e580724f42d3476771d0840f2706d7e503ba4cf7d07bdebe0b315e
ff009440030c890895791eb388480f7d61f97fb045285bc89379958f4068668081586
0287adc699daf83a3ff3ab9dfbca23eee282b7c74f1c1f080e1c093b34428a569ee6e
0da9c90395d50e0ffb34739acce3a1a2b0602f4798dc419241bc10518f49203f90122
475b3ec5ca7b558016006a6688e6
handshake_secret: 29eb048c003b6eb1f58c514f37a4be43ceaed0598502cc2179e
b589fecdeb6bd422531e754539a11003923ad244c3ba1d49ab6c5a9fabea78348f3c5
017c50ec
handshake_encrypt_key: 45137b721d831ba96e69054ff5d93038d153e65b622cb0
be0b4e8a98f6a6c27579bfeffffae8dac5a7b4c5c693d14c1a2864dc488994c7efb29
8f21451b9370a
server_mac_key: 938131c0a95c0d83be7cebbee602627dfecffe01e1ecefd609f0f
946d6ed9010bee470e43bc49acf1806cb539458ad40e4ceb31d688d0cf11e7c2a7c7a
c6e70d
client_mac_key: df970c3011ef4db8661b2b55d8ec33a18a93a3a9c375d37ec9b70
0d3468c61e8686fdd92c8a9b53963205ad651f13401e0848d94f9b7bf09065099d80b
7f2654
~~~

### Output Values

~~~
registration_request: 02fc4b3addc3978fba0bdfacc4fc662bc8af59e00392b0b
6b5fad9a5d6a60a015b4a0e2d1c8e2f95e229fdbdf50ab93a7f
registration_response: 02ba75a6a537e88c57e67208566dfa0193387002d3028c
a8cb0a2c08c2880f1ed91335a6c289d1620feea05b6243b181280251f78cbd5c7a3fb
f4cdaeb755eb8cc4159edb0ef38baebb503dbefed5c89c14f7c2b99ed242b3d1de890
f7515bad94bd
registration_upload: 02c86369d6eae0978bdd4030b43e0619ce46ea9d91fa6e0e
7575bb12aa4857db98b952d8af9d92f75899c49d0d18793c1e016b1e580724f42d347
6771d0840f2706d7e503ba4cf7d07bdebe0b315eff009440030c890895791eb388480
f7d61f97fb045285bc89379958f40686680815860287adc699daf83a3ff3ab9dfbca2
3eee282b7c74f1c1f080e1c093b34428a569ee6e0da9c90395d50e0ffb34739acce3a
1a2b0602f4798dc419241bc10518f49203f90122475b3ec5ca7b558016006a6688e6
KE1: 02778d77bae1e5e05311469840b632fc724f55070922598457dcb06b22f8fa87
d6ba7886fe34283d8727a1e1d30251a5c9e3c133d95b8eacd5551d9f97a5342cadcae
d43ce4156c5bb3a1d23f063e9c428000968656c6c6f20626f62027044d31354b5b985
87d7d144526f6c8528317cc3e9675c90a1952f4bc2725a6a154f59aed10e4ff7ec68d
4917d74122b
KE2: 03ad08056e57dc6424c6210d7e12801ec7de62e2de9decc6f034d000dca821ab
aca9d733e8807d072bb8c211c477d27fc20251f78cbd5c7a3fbf4cdaeb755eb8cc415
9edb0ef38baebb503dbefed5c89c14f7c2b99ed242b3d1de890f7515bad94bd016b1e
580724f42d3476771d0840f2706d7e503ba4cf7d07bdebe0b315eff009440030c8908
95791eb388480f7d61f97fb045285bc89379958f40686680815860287adc699daf83a
3ff3ab9dfbca23eee282b7c74f1c1f080e1c093b34428a569ee6e0da9c90395d50e0f
fb34739acce3a1a2b0602f4798dc419241bc10518f49203f90122475b3ec5ca7b5580
16006a6688e67eff21eb659aa360da7469e5fcafc9257ed13c43cc4cf2e9137653c34
8a8ccdd035684e8cdae6ce360c2d3f41e4b059f34f986e92dd50c8255f7d7dc0c1625
2ef9b8c9fb9e0c2846053355e7fcfa46781f000f1f2321513057eebd15e2baaf6855e
26f2ea54269cc5f256fd6dd0bd354178ba359d9391aab68dd5880c0d4af92219be485
38cec27f5a4dacdc9d4d30e91f436de696c1c248c56427cad2432b86bcc3
KE3: b7ef29d325425d422dd705b5715ef951bc03a25598e8c11d020667d6408d3c1e
f8c6a2eaade4fd9eb7701b867bd9c4f4e4c99447b0e3ef02fd49f525c2dbac01
export_key: a509bb22ef11e79d5c153691fc3346ea55596bef995fdfc28e1bab7bd
21736bfd56edaa222e7eeb3ae8d0e063a8933ef2f2806b6717a97a9edaaefd2a670cc
24
session_key: 69cb495ab87db111a937f82dee16f9bbfa19cdf2c9789b2d9976f8f0
0cd026c6ae1473c0d3bc4c399c0e66bbc1830b952cf08dd797d6d5572692e2eb8cbc8
bc7
~~~

## OPAQUE-3DH Test Vector 5

### Configuration

~~~
OPRF: 0005
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 01
Group: P-521
Nh: 64
Npk: 67
Nsk: 66
~~~

### Input Values

~~~
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 89a1b879154ac36089ed5623c24f4eedd2ce5ad01065a492c2544
aa1784a47c7
client_private_key: 004274252f29a6e19915f81b0c7dcea93ce6580e089ede31c
1b6b5b33494581b48678aec1d0c3d16afd032da7ba961449a56cec6fb918e932b06d5
778ac7f67becfc
client_public_key: 02000202cbe2dcdfe616ffe600cbe24768cdba3066d53d2b58
feffa43e199c833f85963a612b79a2fbfb065f34e2edf51e39ba3db9cbdec0fffcce0
113a5c05b2c28b1
server_private_key: 000739878b22e5c4833d34c486a8510e7cca4c1b81ece04f4
7e8d2554a5ebd83679b4c1e67ed82f2891751aa7094602be672c324929abb1876a7f7
165ac7ec79bfd6
server_public_key: 0300159aed22eed3a1ca9e7a8b063b1b62c3a48b00b7b83edf
6047defdb1b05e14b14faa77afb5f08ffaa04cc8c5df59983e42677f7b6c8d63c0348
15367374543ed1c
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: ec5c02f66ace74efd08a3ef5902a4da83d9b7b6c894ed542a314536
9fd442ab9
client_nonce: fb6bbd024ee3910a8d5a5cd57f3775c085ba07a4533855057b28345
52374ed09
server_keyshare: 02003fe52f2e417b5c448309d4a54363aa84725feff99da4639f
caa9d60e5b1bea54a7f5661b05bd4d3a662d6688a76f177c63d1f1a548ff00d5d6c6f
b331b56e1b890
client_keyshare: 0201a487b80b1f7927e7e44eb0cea2498ce462ab21fcb4b8e987
27aac9e91dd8f8e22338953560a0e088934084f2a27b85b31a3ba55b73ff9a0d17333
4667996078929
server_private_keyshare: 0134471b1e6eb4b043b9644c8539857abe3a2022e9c9
fd6a1695bbabe8add48bcd149ff3b840dc8a5d2483705fcc9a39607288b935b0797ac
6b3c4b2e848823ac9af
client_private_keyshare: 002d816be03432370deb7c3c17d9fc7cb4e0ce646e04
e42d638e0fa7a434ed340772a8b5d6253d35895f4cff282d86b2358d89a82ee6523ef
f8db014d9b8b53ad7b1
blind_registration: 003f281099ef2625644aee0b6c5f5e6e01a2b052b3bd4caf5
39a41fabd4722d92472d858051ce9ad1a533176a862c697b2c392aff2aeb77eb20c2a
e6ba52fe31e13f
blind_login: 01c28b45f65717a40c38f671d326e196e8a21bf6cfd40327a95f1ccf
c82a9f83a75dae86286729214a1ba9a359ab01833477b8cb91932d0c81667a0e3244b
896ac15
oprf_key: 00363749be19e92df82df1acd3f606cc9faa9dc7ab251997738a3a232f3
52c2059c25684e6ccea420f8d0c793f9f51171628f1d28bb7402ca4aea6465e267b7f
977b
~~~

### Intermediate Values

~~~
auth_key: 4bcc80f784e0dcfe56b2e9f5fcd75423c009fb1a3c69c811e5705eba729
e5dcfaaa22feba520cf9e68d00f5baa2391e57602716655c7d946f7cb1e9ef5956756
prk: 31fff49c1014c2380710727d4285e5f20a27ef231272d06933d6bcb60f47e309
2c5264c3ffde016475eb1c84b5b1b136a4e4fdf08eb3e43d10d611f2effb26b2
pseudorandom_pad: b115bb282d9857c8c6b3d12f3481f0ecfdb2350dfee79d9c2ab
7083723605a67fe7ad5103bf5bf156e12e7cc829beddfe28c86eb58ef5f22b6974ea4
8fb2389d5687
envelope: 0189a1b879154ac36089ed5623c24f4eedd2ce5ad01065a492c2544aa17
84a47c70042b157cf0d02b1f1295fa6293438fc3e45c1546d03f67943adeb01bd8417
f4027cb61d5ffc26f98203c1c2d516f9328c9b78da482da37ed1b19d919bd30575cee
6ba7b00a58ae487c357b2ab7ade3fa6a66e831cdbd9d247a1ad24d72b61689d7c3606
e5b2321acccedd8ea59371632947de4e338c00c1d344cba91c8b62beb790cfe4
handshake_secret: 76e72d8d61dd99eb00880f2207d24dddbc54e479a30657bdc66
c0a628a21573c3552f5a746a3367d2ba9a882e12c92a5862a4868e96696dc9c955a52
43977334
handshake_encrypt_key: d19144ee44f4e0b3995dc54f0a736966c2f1781de67e28
0a52fc906fb848532a106413f74a21509811650ef87ff016e704ed2f02d72d4f7db2c
d23dc6ed2c632
server_mac_key: c2993e113b17ba50e1e991399841a9a3139420d0c09f85f31ec4a
489778413ee8d54c50ae693047075f316c95625d3ec7fefd3ffed97f787c37a8c1241
5aab93
client_mac_key: 37f8c9718b5d9a5a7093c1a1f01b1639fd53695914205e06ada52
211961ee6220c1fdfe143583d30d471b032b8f855a3fc13a4d88aa0632b22404cbc2f
6dbf59
~~~

### Output Values

~~~
registration_request: 03016af598df5549c18c7f904ff395006449477bd594663
b2948142db6d2aac90d204900d669b5e73cfefdc91d7bee857d9522eb996601d2c3f8
25221ed46f51c89ec7
registration_response: 0201b7e055f71ebc3020873cd002596dfce243891fc7f2
278ab1c5bf768886067e779ce4d922dfaa87e3dae9ed4d1ba2bd19ee24c2f33f3f19f
89d5b0eb6865880659c0300159aed22eed3a1ca9e7a8b063b1b62c3a48b00b7b83edf
6047defdb1b05e14b14faa77afb5f08ffaa04cc8c5df59983e42677f7b6c8d63c0348
15367374543ed1c
registration_upload: 02000202cbe2dcdfe616ffe600cbe24768cdba3066d53d2b
58feffa43e199c833f85963a612b79a2fbfb065f34e2edf51e39ba3db9cbdec0fffcc
e0113a5c05b2c28b10189a1b879154ac36089ed5623c24f4eedd2ce5ad01065a492c2
544aa1784a47c70042b157cf0d02b1f1295fa6293438fc3e45c1546d03f67943adeb0
1bd8417f4027cb61d5ffc26f98203c1c2d516f9328c9b78da482da37ed1b19d919bd3
0575cee6ba7b00a58ae487c357b2ab7ade3fa6a66e831cdbd9d247a1ad24d72b61689
d7c3606e5b2321acccedd8ea59371632947de4e338c00c1d344cba91c8b62beb790cf
e4
KE1: 020142931e5e870e35226b46f8a9692babfabede9ca86ffded305ba079274920
aa78f9a45341b6693765e601237d6a6bce8ddf194f6161144e9a2a1bcaa5860e6637c
dfb6bbd024ee3910a8d5a5cd57f3775c085ba07a4533855057b2834552374ed090009
68656c6c6f20626f620201a487b80b1f7927e7e44eb0cea2498ce462ab21fcb4b8e98
727aac9e91dd8f8e22338953560a0e088934084f2a27b85b31a3ba55b73ff9a0d1733
34667996078929
KE2: 02000c9ca900d4b470d043136562cd7d9debe13d6595a274e46a1bd9a7a2e3d6
19f6a7cc0324f30fc8fa10f8eefcb7e968c6f2e50cf0e2ee3487d9a80cbe24255600e
b0300159aed22eed3a1ca9e7a8b063b1b62c3a48b00b7b83edf6047defdb1b05e14b1
4faa77afb5f08ffaa04cc8c5df59983e42677f7b6c8d63c034815367374543ed1c018
9a1b879154ac36089ed5623c24f4eedd2ce5ad01065a492c2544aa1784a47c70042b1
57cf0d02b1f1295fa6293438fc3e45c1546d03f67943adeb01bd8417f4027cb61d5ff
c26f98203c1c2d516f9328c9b78da482da37ed1b19d919bd30575cee6ba7b00a58ae4
87c357b2ab7ade3fa6a66e831cdbd9d247a1ad24d72b61689d7c3606e5b2321accced
d8ea59371632947de4e338c00c1d344cba91c8b62beb790cfe4ec5c02f66ace74efd0
8a3ef5902a4da83d9b7b6c894ed542a3145369fd442ab902003fe52f2e417b5c44830
9d4a54363aa84725feff99da4639fcaa9d60e5b1bea54a7f5661b05bd4d3a662d6688
a76f177c63d1f1a548ff00d5d6c6fb331b56e1b890000f0a301c7d799896e93cff10a
d7a7dbac55b3a76c827743e899ee954d4b36b158e9bd237738871508a803c917b9036
cc2039dc7631244bb6e33cd18eaeffc982fb6e5d5c853e3b82f6300cc90ccd7b2d
KE3: dda160c6b8888fd7c53934b6e95106a3aeea39db0c4bffe23089875cdcdee5e3
ebb849bee2b22849a2af8a5eb4f5e05d94d56c9b205c20aea624ee19e2c04904
export_key: d52e411056d47d4acb0569141bdf0f6c1613a495b0dbdcd727cd8db41
2be2b72b60f48b89fad231160e659a070b74118966a1bd6de2e3320c21926d8fcb5e3
3e
session_key: 92f7ba767592a429ea5f093da3fc331f51224c406ce7f8b3266b2728
9c85084d98c193f502fc4cc78f6a80085365f8e66861fca92682efc9f827ce3bab43e
f79
~~~

## OPAQUE-3DH Test Vector 6

### Configuration

~~~
OPRF: 0001
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 02
Group: ristretto255
Nh: 64
Npk: 32
Nsk: 32
~~~

### Input Values

~~~
client_identity: 20fa92f2e4b7ea5b5e677ac4930ff3b93b0043481ab70bc613b2
e16a6dde6b05
server_identity: eae9dfa6b8348d34418c32d385e1eac99efbce1af320901f7c8e
de8d6d272c65
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 54cd539b090014c3ac095611ba067be43c8592ddcbcf234f36569
8f964ed836f
client_private_key: dc70a99bbabf1ebe98b192e93cedceb9c0164e95b891bd8bc
81721b83d66b00b
client_public_key: 20fa92f2e4b7ea5b5e677ac4930ff3b93b0043481ab70bc613
b2e16a6dde6b05
server_private_key: 709687a36c94592ab76579f42ce1be6961f0700496e71df80
6ebd5320554720d
server_public_key: eae9dfa6b8348d34418c32d385e1eac99efbce1af320901f7c
8ede8d6d272c65
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 539290dde2ab6046896ff9dfda5d149f5ffbdc7ce165dffaa1c1b03
4a1af27df
client_nonce: ef2e5f21761e7c387a770e6ab729fd31203c29acb18b146da3ba2a7
02cf905ac
server_keyshare: 96a9587e233e67f2397f10fec6355b68102534f1f1b115b4ddf7
485840efcd7c
client_keyshare: 54f35db3a52fb0cf2a97918a6987993231d227e28711eaef19a3
e5033632611a
server_private_keyshare: 6650d64df70618a878504ce73dcca27b1af125c67e48
1e7bd49d0b24709b200f
client_private_keyshare: ebb01c59f99bc955df622548e247f7ef180732909ff3
c5f87ff8c7867b8be704
blind_registration: 308f1d3fa1fea402f3c90b04601274050a3c6f467387c2f48
878823949b0e109
blind_login: 141e21373228a44b09d4c00da9a6bbaf9a5e54a1687c07f327833643
4245510b
oprf_key: b7126967aa0cb69c311b71343843ea041bae30e2bde41b548b8fbd8bced
97604
~~~

### Intermediate Values

~~~
auth_key: 8e7357bf9c0d2a846452cdd3956d454365df0d307d619cc57e0eefa1aef
31b94e7eaee4402c13f0e508cbcdcc87e9cd1b18e08a258ae185bf74646379468ad0f
prk: b4d69d383cf93c3ea746a668b55de501a574a0aad0a7062e56d5f9942b5dcdf4
7109fb186261a209e7bdd20cde44c15a6095afc36f402cf1e2108783f11b8302
pseudorandom_pad: 1b83a29b29d86d9959b18621522ba3c639cd262236f124d5da5
75817ade23ffd
envelope: 0254cd539b090014c3ac095611ba067be43c8592ddcbcf234f365698f96
4ed836f0020c7f30b0093677327c10014c86ec66d7ff9db68b78e60995e124079af90
848ff6ef0b9e59e3d41ccbe83e08cfaec1124d3e557b8b7ffe4225e5a1f40bee6c077
6238028b6ab6c331534b35afde8806e7e4fb73b2eb255aa1484e6b5b608a3c3ac
handshake_secret: fd4ce6630386646324016ff5e8aff286e8325666ced7df3a39b
cfa200ec5c0d501505af4150439b14101ed540cc58c15e9ed0c6e8d0ae03c1758727a
bd2a20cd
handshake_encrypt_key: 9f13439e483065b0657dd575c30b56382e3fc9adec8e3a
171e3448ad13cb74be64af7968fb6109a3661124fcef29dd3e29f350f6095cdb97dd3
df2fda07c5273
server_mac_key: 70ac95f82f1936b945bd29dcafe19d17e9fd06f27eea1893ed1ad
af7ec596afe478125413cfd510406a8e93ffba72792c432a7cc93b1176c7ac3326882
6b5e60
client_mac_key: c0d5bfd0367a6a09c1b07a61703d2b4cc41e47a2e3a1372472c93
5a0b531f2f0902a038496768deadf5f8cb867c0b59df48682619f4e9a0c7c909ac0d2
cce2a4
~~~

### Output Values

~~~
registration_request: 3c8b89966e261a5aaf7aeb6dcdd94c87ce311bf197221b8
7ef44632d58f18a05
registration_response: caf9243d7ef3e267815632bf79c85a27a23f218a438815
2a523f6a310949807beae9dfa6b8348d34418c32d385e1eac99efbce1af320901f7c8
ede8d6d272c65
registration_upload: 20fa92f2e4b7ea5b5e677ac4930ff3b93b0043481ab70bc6
13b2e16a6dde6b050254cd539b090014c3ac095611ba067be43c8592ddcbcf234f365
698f964ed836f0020c7f30b0093677327c10014c86ec66d7ff9db68b78e60995e1240
79af90848ff6ef0b9e59e3d41ccbe83e08cfaec1124d3e557b8b7ffe4225e5a1f40be
e6c0776238028b6ab6c331534b35afde8806e7e4fb73b2eb255aa1484e6b5b608a3c3
ac
KE1: 8261a1efd78bea73faf256a23c200d729259886530fa43b875c1ca124b09bc7e
ef2e5f21761e7c387a770e6ab729fd31203c29acb18b146da3ba2a702cf905ac00096
8656c6c6f20626f6254f35db3a52fb0cf2a97918a6987993231d227e28711eaef19a3
e5033632611a
KE2: fa1f33a43a03123ebe35345ef93aa23b57ea8bfbee7022b05a179d60768ba02e
eae9dfa6b8348d34418c32d385e1eac99efbce1af320901f7c8ede8d6d272c650254c
d539b090014c3ac095611ba067be43c8592ddcbcf234f365698f964ed836f0020c7f3
0b0093677327c10014c86ec66d7ff9db68b78e60995e124079af90848ff6ef0b9e59e
3d41ccbe83e08cfaec1124d3e557b8b7ffe4225e5a1f40bee6c0776238028b6ab6c33
1534b35afde8806e7e4fb73b2eb255aa1484e6b5b608a3c3ac539290dde2ab6046896
ff9dfda5d149f5ffbdc7ce165dffaa1c1b034a1af27df96a9587e233e67f2397f10fe
c6355b68102534f1f1b115b4ddf7485840efcd7c000f32cb65026f996c3838716d302
454eee577a049edb36c5d06f9faf4a2eced065c07f4db4767bf3482bdf4014177b963
4f5f419bcb0606835bd417de4b4a2425c7f32faa49c4395aab6192d75d34e9fa
KE3: 734742138587e8553944a16f7e3f12554c54e96d7361e90c909e5de518267c46
676e3b514c68564c6dd60194860f7f425d816042fcf00c0b15ede703216f5fe4
export_key: 5e373cf62e2e1ee77b527e514eeb2844d69285401b5a27a7dfe8fb889
7a56190acfa179f68368ed3bc2068ab05de63670e691a0bbfde9d4bed6e1b57ae008a
ec
session_key: fa3156746b8a70e812aeff1dc50e7587dcc31acb0bf1705827918768
c3e9dbbd893de24e890c341aed9c75a1bef6fbe36f150a2da706ec989013238c3fd94
2a1
~~~

## OPAQUE-3DH Test Vector 7

### Configuration

~~~
OPRF: 0002
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 02
Group: decaf448
Nh: 64
Npk: 56
Nsk: 56
~~~

### Input Values

~~~
client_identity: e0f6146168d32f4b68e042ed5d5608d1108e84a08b6688798ead
0810b4f10d7a91f0767e197e946ebfc487bf62a5ed5684e7ab9137ee1862
server_identity: d49500848e7c06c8a5dd5bda74930ffd20fbef9a2de24a0068e5
bf3dc356852b10327be9803983271450bc6a8c683abcdd73883ee63543e9
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 4196d2ae8961982f0c1bbc028aa277cdbcd22b0d3b83f2c22eec4
33a86fb3b8f
client_private_key: 0a45c82e38a6ab6fb99ec1df7423e25a7851f9558e7a05166
03c9d0201b409c3fd0f0fe78bd37bf60927fafeca73ed8093538a9992c62235
client_public_key: e0f6146168d32f4b68e042ed5d5608d1108e84a08b6688798e
ad0810b4f10d7a91f0767e197e946ebfc487bf62a5ed5684e7ab9137ee1862
server_private_key: 64666faa068e5ff9e00d588446b7d6cdc09ae8df069b30987
a2cdd39286e0481a2eb899f4e0db672264527a8115f176c53709a4f6534f328
server_public_key: d49500848e7c06c8a5dd5bda74930ffd20fbef9a2de24a0068
e5bf3dc356852b10327be9803983271450bc6a8c683abcdd73883ee63543e9
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 1eddb2d3e03b3d0a986dc5456eaf0351218efa8014e1de50605001f
a71ae7c82
client_nonce: b307ae6cde2c11e74877be923110ae1c0560aae52907542b75b098c
b0c011cb4
server_keyshare: 720df48b9e395c40448cf06a80bc9c1d90ae1a3080e4ba3368ca
056ba92921f79d67073fb91b7c94c3f3d33cc01613d7221f54fecd80bcbb
client_keyshare: e6f2ab22efb569a19f48355c7d5d4f728faf3a9142d45c20c098
bcbcb6c12fd92480bfb4e532923e64b9620b6bc84ac5f2d8f84ad466fd18
server_private_keyshare: e5d7202d6ed8cc45c4502850974076d720343b566089
1b5ab5655c3defb4b39b35b27ea20eb0bff035e9b9cbae6cfca36aa4827c32abd905
client_private_keyshare: a54c0d7bf4ee396a0e4a3f023b35698aaa93a2be8bb6
32747671b3edeaedff07116afbb5e73cbc273e2e0d0876780343578338425ed81d3b
blind_registration: 9d557ee103479baef585ba8017f7659cdd0b804c093852519
9d88853b52ccfc7802d09cf38ba35e36db24404602da8a616e7ad8f1c05cb36
blind_login: eaadba538bf67207633a956ea71fbd02ea2dbfe7e195dbd26ea562c6
f2406fe1df1367f98f6707dee9b2e3ebd9842b0442e25d086e099231
oprf_key: 98a5689edb98ed3424fa5c8584423c6b047121fc36fcec934c8ad24a98c
86d00e1e1d6d3d923a46519065977331abaa1e3c0d86591458b25
~~~

### Intermediate Values

~~~
auth_key: e8a73596e707e66231bbd58f0f21e46eaff0d5980d47f15f2091c644778
bda3d650134e5fb7b993ceb65945b4dee125bc82467ffa75240cb3e026b2a86cd7300
prk: b51ad721f3b3eb053c1c8377a6c8e983ded77bdd127ba18e564d1234f4d5df12
7e7c4d952b1f674a5124e3bf3a91b8585ce84d51af4d43509dfbe72217f9069e
pseudorandom_pad: efa27976b3cebcfdbe3343b273f1d34061d1495e547b37dc33d
58565d1696a4539bb24d986617dd761f99ec7ccca2aec388220a5e54e3c31
envelope: 024196d2ae8961982f0c1bbc028aa277cdbcd22b0d3b83f2c22eec433a8
6fb3b8f0038e5e7b1588b68179207ad826d07d2311a1980b00bda0132ca53e91867d0
dd6386c4b42b3e0db2062168de643906b9c76cabd1aa3c77881e0438d16230c9ed161
e467437054a84c54fb46f7261f0a0cb091d1403bb85302b5eed89d050799250465c39
4a0363ab3434439672ec0b445de7a04de17a61f9b7a9
handshake_secret: 8b9095483be3abb6221f405bdf9b36f6697ad898e5936076b33
54782ade7207aca995b6aa319b31120fb5443e49b1ee3ba4a82890350d80d06ceeb46
03f1f31a
handshake_encrypt_key: 79d7bfa5e5e621da90507c3a8501e00b3569b69a03c142
4c868f96dca45337781a149f484b6786a92f07dbe4bf51d879eea09697270997487a8
d1d7cd8480955
server_mac_key: b4da51a86cd390b0faa0819b9dacdad65b3488cb6128cceceb38e
8d9c607537368875914c001a4e5a7db71298b0b97987cbeb068a51504a83a61a52a23
c2aa0b
client_mac_key: ead9c2e709a17870d72c5cc01715e695e01cc98686146b7fd1665
1c4789b77605c9a48407f81296ea3847c55f864dd8b264512e1b08727bdcbf98e3ea2
07be04
~~~

### Output Values

~~~
registration_request: 90cca9013769f28f3992f77a043084edbfe6c89b7e2305e
4a6765e50df565fa8e18aba470238c6ed7992af20e962a641bc6bd678ceba640a
registration_response: e45f47bc6f41bb6de778775aa3f746b31cd17969183beb
e8b3757ba8dd546534996ccc686709c1a0fd6ecb4313936940a470333d1ae3c70ed49
500848e7c06c8a5dd5bda74930ffd20fbef9a2de24a0068e5bf3dc356852b10327be9
803983271450bc6a8c683abcdd73883ee63543e9
registration_upload: e0f6146168d32f4b68e042ed5d5608d1108e84a08b668879
8ead0810b4f10d7a91f0767e197e946ebfc487bf62a5ed5684e7ab9137ee186202419
6d2ae8961982f0c1bbc028aa277cdbcd22b0d3b83f2c22eec433a86fb3b8f0038e5e7
b1588b68179207ad826d07d2311a1980b00bda0132ca53e91867d0dd6386c4b42b3e0
db2062168de643906b9c76cabd1aa3c77881e0438d16230c9ed161e467437054a84c5
4fb46f7261f0a0cb091d1403bb85302b5eed89d050799250465c394a0363ab3434439
672ec0b445de7a04de17a61f9b7a9
KE1: a8f3c6290c4a31a2f696ac5c4f933c85dc3a8fde4247e8733fae3502b9f895ed
40a43c53547891e0a6305a12f7bbbed8696a774f2f352b1fb307ae6cde2c11e74877b
e923110ae1c0560aae52907542b75b098cb0c011cb4000968656c6c6f20626f62e6f2
ab22efb569a19f48355c7d5d4f728faf3a9142d45c20c098bcbcb6c12fd92480bfb4e
532923e64b9620b6bc84ac5f2d8f84ad466fd18
KE2: 3c86de1f2ef35f9044b08421334c2ea2020300a3c5259bab2fd525dd4e68e03a
90d3460479849e12847a3600cf2428a4c424741b96f76aa9d49500848e7c06c8a5dd5
bda74930ffd20fbef9a2de24a0068e5bf3dc356852b10327be9803983271450bc6a8c
683abcdd73883ee63543e9024196d2ae8961982f0c1bbc028aa277cdbcd22b0d3b83f
2c22eec433a86fb3b8f0038e5e7b1588b68179207ad826d07d2311a1980b00bda0132
ca53e91867d0dd6386c4b42b3e0db2062168de643906b9c76cabd1aa3c77881e0438d
16230c9ed161e467437054a84c54fb46f7261f0a0cb091d1403bb85302b5eed89d050
799250465c394a0363ab3434439672ec0b445de7a04de17a61f9b7a91eddb2d3e03b3
d0a986dc5456eaf0351218efa8014e1de50605001fa71ae7c82720df48b9e395c4044
8cf06a80bc9c1d90ae1a3080e4ba3368ca056ba92921f79d67073fb91b7c94c3f3d33
cc01613d7221f54fecd80bcbb000f3ece15765fd5fe509ef0141cb1cb968060cc99c0
bbe95947a829559924e6434b45ebd13f59c2ade6501cf9776c6ff0dc7b8ef4759efef
9026f7963bd47057952b5702e2df990df5015627b74126fc9
KE3: 769f974c2c2666b42e58bcdcbf56c5b01ce5b373461609e34d29df8538a61d06
b969f8526b8b1de040136ecd72222698689f191516326936cea09c3feba1a949
export_key: cdba44f69a6b30fa7499a038ecdba80b5b360e6c996253581872e979f
d3be214922985a6685adaf938c1f54efd663c8772c26ea7bfced7bbbd4d7715d62034
33
session_key: 4b6138cab24778d123d487e8b8c3d1225362b4ab8f98ff2174481593
d467cd2f3bba8829a837550de95a5091f9f2005c8e0b8e9b839462782c0504048e853
f5e
~~~

## OPAQUE-3DH Test Vector 8

### Configuration

~~~
OPRF: 0003
Hash: SHA256
SlowHash: Identity
EnvelopeMode: 02
Group: P-256
Nh: 32
Npk: 33
Nsk: 32
~~~

### Input Values

~~~
client_identity: 0227aa37ade0cd6231bd385333cc8ccdf3872e75d9f6506192ed
7bcc6e5819f5d7
server_identity: 039178fd762b694fc67cc2df224079dd59ccd00d22621929a0a7
e5ecac96814260
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: f918ddc6f6c994f4952948069c51e1da23b6af416debdf668f31f
970449bc293
client_private_key: dc970d63acb5ab74318e54223c759e9747f59c0d4ecbc0873
02667fabefa647c
client_public_key: 0227aa37ade0cd6231bd385333cc8ccdf3872e75d9f6506192
ed7bcc6e5819f5d7
server_private_key: fcd9a655f77ff0b2ebcfe21e1a1ca4a84361e9f1b18e24c9a
40ed5eec262bf52
server_public_key: 039178fd762b694fc67cc2df224079dd59ccd00d22621929a0
a7e5ecac96814260
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: ae798240835b82d886bb026b027bb4933580698ea3063f2f4d3e2e8
ae43a449b
client_nonce: 315d730e18631dbadc0ba793dccae751ddb2044c6bc97d9cbec1d4a
c27464dc9
server_keyshare: 0233c66a7b8735e362aa803f2e5677f48f4cab048edd74381667
82858e46381fd8
client_keyshare: 021ed435f437b88157c9af824de01811f5afc20de9dfdb49f0b4
454ec1df60af60
server_private_keyshare: 4fb9234e93a8bd048ad9f44b428026396a810328c405
a354e666f086fa0ea476
client_private_keyshare: 4fb56527be010296ea880e1c6a4dbbc9ede543a2ad0f
83fd60fdacb59801a9d9
blind_registration: a54f137dbe5f5eb4a34dcb73609c6693f28cd3d57ed77bf66
e0ab7d86c6990f1
blind_login: 3b5d1c0fc0812c10e18f146b14d7eb94755a918bac1ef8d69d21a7c1
3f95c9b2
oprf_key: 334d8af16ae1e69f5adc24e5aa89ebb63637c835fd39b17a1a4453eb5d9
63d23
~~~

### Intermediate Values

~~~
auth_key: 1c8441267cbad9f56dfe31ed17a30563fa68f1a77c51921146c25b792f7
e6f81
prk: c4fd0c02a12820c952203aae2b8c48064fb2b6b0df9c028724d78a4ad5a17b21
pseudorandom_pad: b3df6f7a77b48f014a6361080597bc53496e24a5b479eaebca6
92ed86b9c9ac5
envelope: 02f918ddc6f6c994f4952948069c51e1da23b6af416debdf668f31f9704
49bc29300206f486219db0124757bed352a39e222c40e9bb8a8fab22a6cfa4f4922d5
66feb961bc82148ff9f59f3a03153a567f3cb58d408b31e9f03c300b52e43d83086a8
5
handshake_secret: 81ca6aec873f8e2db3386d0090dc8881bb4cc4514cd29c3d077
5a66c9b50088f
handshake_encrypt_key: b4eb027603fc936292c84367e8ae23b5d2dcd7826b90b2
766b714b887d6efeeb
server_mac_key: 4d73d30cf192c8ec4649b278ec0f4ecb1ff1d5d2fbebeb607ef61
861b0efd7e2
client_mac_key: c70fbe136b5beb60b5e6c65c8fbf7cfe72a03cdb98f4c488492c3
d1706e2e6b2
~~~

### Output Values

~~~
registration_request: 02327e93445af116df70f57d18ab2a0ef9f492aa3d76c94
6d98260fa1edfa5b832
registration_response: 03480ac383e647d1f78b19bd902c7126024ccc76da605d
cc416581a32e4202d62a039178fd762b694fc67cc2df224079dd59ccd00d22621929a
0a7e5ecac96814260
registration_upload: 0227aa37ade0cd6231bd385333cc8ccdf3872e75d9f65061
92ed7bcc6e5819f5d702f918ddc6f6c994f4952948069c51e1da23b6af416debdf668
f31f970449bc29300206f486219db0124757bed352a39e222c40e9bb8a8fab22a6cfa
4f4922d566feb961bc82148ff9f59f3a03153a567f3cb58d408b31e9f03c300b52e43
d83086a85
KE1: 02dad65138d90eb5fffdd93d1ad84b7e86e5b3f1964756d092e154d6a135c6e4
ce315d730e18631dbadc0ba793dccae751ddb2044c6bc97d9cbec1d4ac27464dc9000
968656c6c6f20626f62021ed435f437b88157c9af824de01811f5afc20de9dfdb49f0
b4454ec1df60af60
KE2: 038782ee7c0ca885bd49d7105f9f43f89d34b2ad39b98e02a1a4ceed9e7de3f6
6a039178fd762b694fc67cc2df224079dd59ccd00d22621929a0a7e5ecac968142600
2f918ddc6f6c994f4952948069c51e1da23b6af416debdf668f31f970449bc2930020
6f486219db0124757bed352a39e222c40e9bb8a8fab22a6cfa4f4922d566feb961bc8
2148ff9f59f3a03153a567f3cb58d408b31e9f03c300b52e43d83086a85ae79824083
5b82d886bb026b027bb4933580698ea3063f2f4d3e2e8ae43a449b0233c66a7b8735e
362aa803f2e5677f48f4cab048edd7438166782858e46381fd8000f6ab7eb241884e5
c2f76a3283e18be5e7e3a709707d9ce8cec3cc3f52411a5accb14d88f3e6de5c261ae
2c6acc8213b
KE3: 89fc87ab7c81a13d0b2c89e6ead6da0539f71cb3ad3bc4584e0a86e90a537c7b
export_key: 2611c2494a8c1014aec67755d187290fd318e76010f2deaf3e7fd64a5
dd737bd
session_key: 9e889009060d117f6ab6fb61884992b68663b9258e52b6075e885211
69f8c2a2
~~~

## OPAQUE-3DH Test Vector 9

### Configuration

~~~
OPRF: 0004
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 02
Group: P-384
Nh: 64
Npk: 49
Nsk: 48
~~~

### Input Values

~~~
client_identity: 0368f5bbaaa438e2e87de012dec549a4a89a6d4deb262b133834
d1d90ed3eeceb12a2c5cfd5702077bfb47b0e36e48904d
server_identity: 024ecf37a198ab5431962c820df129c60356bc801d3584da5ce1
19c15554d0183a3b9a6b833cd2a019a882c620020c8a3a
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 19dbdb204f1a017b3408d66446ad2adde7f56c61389d1678796bb
10ed527344e
client_private_key: 26fec54d4567adabd7951ad51ea3741feab175ac5cf7fa02f
3ad744eb5baf418275e45ab31ade30669dbae98fb087953
client_public_key: 0368f5bbaaa438e2e87de012dec549a4a89a6d4deb262b1338
34d1d90ed3eeceb12a2c5cfd5702077bfb47b0e36e48904d
server_private_key: 8588213957ea3a5dfd0f1fe3cda63dff3137c959747ec1d27
852fce42d79fc710159f349e7da18455479e27473269d2a
server_public_key: 024ecf37a198ab5431962c820df129c60356bc801d3584da5c
e119c15554d0183a3b9a6b833cd2a019a882c620020c8a3a
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 828c0164f34c6172b62f81f5aaab3e1f6b87bacf9b34313b044a040
cfe089e1a
client_nonce: aa300ade8835d1a0fcaf64d814fbfe0b513e3378fb543aca8e0d2a5
fb43131ce
server_keyshare: 036b981c4a2265b4376e2edc3186a45c2e2f820b1092784f6448
354779578b442b0369640e2f10a856cf8dfd60b28c68c9
client_keyshare: 03526fe798e9ab52137d8c3408b131430eadae49f6e93a4fa228
c0338081e6090f75c2b3d55da4b2abfa4f2e2a52bd3330
server_private_keyshare: eb81ae8c1af769a56d4fc42aef54a703503046d8272e
aea47cfa963b696f07af04cbc6545ca16de56540574e2bc92535
client_private_keyshare: ac475d6a3649f3e9cdf20a7e882066be571714f5db07
3555bc1bfebe1d50a04fd6656a439cf465109653bf8e484c01c6
blind_registration: c044df390ab5683964fc7aabf9e066cf04a050c4fd762bff1
0c1b9bd5d37afc6f3644f8545b9a09a6d7a3073b3c9b3d8
blind_login: f8516f98f3159b3fed13a409f5685928c72d9dab8ddfe45de734ce0d
4ff5823d2e40c4fcf880e9a8272b46eea593b10a
oprf_key: 5e7d38ba6ff37c42b3c4859761247a74d0c62c98ddff1365bb9b82b279e
775b7220c673c782e351691bea8206a6b6857
~~~

### Intermediate Values

~~~
auth_key: 775d5c7e64f2e5feb787d3a0cb332a7b82d6a5dd1dec644a54d7678fe23
76c5d4fdef608ebe2a6acb4d9e2b94c208cf6b93dc18e9b91a98d2c97563019a2e4a7
prk: ad4e553df1b731993d5b333e70b9a077ea78674bcb4e013d4b575a8267dcf36f
34db2997f0b3fe4b68e9482e5f5539dea64230746478ebb9a39cfc81cc6b9fdc
pseudorandom_pad: 3d4fc9c0b66249a3c19e5a06db3a842b9e9561687ef2ac234cf
2b5fec146d371cf2ac52723beae9742202e0a71404e99
envelope: 0219dbdb204f1a017b3408d66446ad2adde7f56c61389d1678796bb10ed
527344e00301bb10c8df305e408160b40d3c599f034742414c422055621bf5fc1b074
fc2769e874808c12134d912bfb80928a4837ca96cfc129b4c710f9f35b8f7a5d747b3
5c4d8cd09914178ebf7d04a6c04d18c3945967c14d2af3ae2cb0f66adf79385d45449
ab8baeb1248cb2960766bd1fe6cb
handshake_secret: 71877c80b2a32dc0ca88480acaf7e9efcd85c7cf4049fc174bf
03cdec7535328ab9f41e328a5700dc7d06906af161cd5c90b84cd35f9329e402049fe
8c08935d
handshake_encrypt_key: e54b44867fbc1281b95877f4bdf4863968f3cf4bdb4504
05be0d86beba520990a096831e1e73e317aa61cfd29502152f8cd20ffe6840e5a6f53
1cf3598423a9b
server_mac_key: 6a240cec573422c10de8ed0433d799893ec58559bd79710d27bda
39baa8b46323346db9cbacc9b7bfd490cc04c36647549cf4bfdf1b9347a599a5dde9d
123e71
client_mac_key: 02461f5773ad13e20a019ce71da4ba79041e405426644fb4d9acb
776c620dac446ca9b18ef7dff06185d03126b8d303a5364b932fee49869f90b5ff415
b03785
~~~

### Output Values

~~~
registration_request: 029674b50d9bec795e53084cb5d6e0f4813804ea378a672
e5e0514f79e98055b79eafa67deed65b040dc1368a7216c8071
registration_response: 02da545d424e985f21cfcac7dd74ceca2177e513ebf484
3659160649ab4a0e5a9caeeba5e79c1fe86ebb5776e8bd4873db024ecf37a198ab543
1962c820df129c60356bc801d3584da5ce119c15554d0183a3b9a6b833cd2a019a882
c620020c8a3a
registration_upload: 0368f5bbaaa438e2e87de012dec549a4a89a6d4deb262b13
3834d1d90ed3eeceb12a2c5cfd5702077bfb47b0e36e48904d0219dbdb204f1a017b3
408d66446ad2adde7f56c61389d1678796bb10ed527344e00301bb10c8df305e40816
0b40d3c599f034742414c422055621bf5fc1b074fc2769e874808c12134d912bfb809
28a4837ca96cfc129b4c710f9f35b8f7a5d747b35c4d8cd09914178ebf7d04a6c04d1
8c3945967c14d2af3ae2cb0f66adf79385d45449ab8baeb1248cb2960766bd1fe6cb
KE1: 02ab0cdb1bf7038717c03d583e311f14c6004c73f78383d4cc6248751aa68ca9
29d717dc6f003de949a17732875bd1aa67aa300ade8835d1a0fcaf64d814fbfe0b513
e3378fb543aca8e0d2a5fb43131ce000968656c6c6f20626f6203526fe798e9ab5213
7d8c3408b131430eadae49f6e93a4fa228c0338081e6090f75c2b3d55da4b2abfa4f2
e2a52bd3330
KE2: 03ed6cdbc3a3b78a9504aeaa0df8a3ff996ab5b8dbd2d74cfeec3c976c434a85
860d6367df02c62989c8ee9b88a354ea30024ecf37a198ab5431962c820df129c6035
6bc801d3584da5ce119c15554d0183a3b9a6b833cd2a019a882c620020c8a3a0219db
db204f1a017b3408d66446ad2adde7f56c61389d1678796bb10ed527344e00301bb10
c8df305e408160b40d3c599f034742414c422055621bf5fc1b074fc2769e874808c12
134d912bfb80928a4837ca96cfc129b4c710f9f35b8f7a5d747b35c4d8cd09914178e
bf7d04a6c04d18c3945967c14d2af3ae2cb0f66adf79385d45449ab8baeb1248cb296
0766bd1fe6cb828c0164f34c6172b62f81f5aaab3e1f6b87bacf9b34313b044a040cf
e089e1a036b981c4a2265b4376e2edc3186a45c2e2f820b1092784f6448354779578b
442b0369640e2f10a856cf8dfd60b28c68c9000f60bc9b5437a857be765931910d55a
a0b0f2b2af82b40f6d235e0db24fdc11c4a510ee99a5cdd0c01c8ea431ab4fad7450c
3e9134b88e40b8127e868206688997004dd0301fb4efa44eb9d7dc2d5a13
KE3: 05ed06ec6a49be49bf7124b547679dceb8895e782310d9770d3f1e1bac6def9a
50e8e64775c549059bf8ba58ab1bedda88f14449f6049d01d48a6ce2ed43afc6
export_key: 63787490d3e946c27ca0bcfb26d1072fdb1ff3ed1062cdd43fa958d86
1cd8aa0d0230ff78bb60ed94f20925a5100e20a56ca2cf480f1d1ded110dc5a55ac27
ed
session_key: 7787c278f94abdc9e285f9d8f3e87ba01d0379ccf2fc129547af3d9d
04861380e3d9cfbcc1e2192dc8add8e7961fcf2f7af36ab34f2e9099a89f9035bcc9d
97e
~~~

## OPAQUE-3DH Test Vector 10

### Configuration

~~~
OPRF: 0005
Hash: SHA512
SlowHash: Identity
EnvelopeMode: 02
Group: P-521
Nh: 64
Npk: 67
Nsk: 66
~~~

### Input Values

~~~
client_identity: 0300ec0addd1ade650f8c2be98b2d7b5b5eb7e1eab56823f9413
327e056e1413055ede83bd893a26f61094a87d108431dc4f95366741da7ec6465208b
9080d17ed304a
server_identity: 0300d1df68b2171f58ffc6a2cdf6cd47f4a672e0c06660ad5ec9
cccbd8fafd4593dc847b3a3a7aedd1baf2d03dad24f1da95e884f3554c0d4915b0d47
172f33eab7f0e
password: 436f7272656374486f72736542617474657279537461706c65
envelope_nonce: 31a698c21261836e5efef74e2ee4c27ca20466e8bf87f927a968b
79f59a468c8
client_private_key: 0077881aa5fd937ec7932e725ac43a07cb3ea0e90b40e0501
e6bdc3c97510cdd9475ad6d9e630235ff21b634bc650bf837aaa273530dc66aa53bb9
adb4f0ed499872
client_public_key: 0300ec0addd1ade650f8c2be98b2d7b5b5eb7e1eab56823f94
13327e056e1413055ede83bd893a26f61094a87d108431dc4f95366741da7ec646520
8b9080d17ed304a
server_private_key: 002e485cccf5018abbf875b8e81c5ade0def4fe6fa8dfc153
88367a60f23616cd1468dae601875f7dd570624d0ae9d7be2e6196708f773cf65852b
da777210337d8c
server_public_key: 0300d1df68b2171f58ffc6a2cdf6cd47f4a672e0c06660ad5e
c9cccbd8fafd4593dc847b3a3a7aedd1baf2d03dad24f1da95e884f3554c0d4915b0d
47172f33eab7f0e
client_info: 68656c6c6f20626f62
server_info: 6772656574696e677320616c696365
server_nonce: 9b685b5f0af1f4f42a5e893e3ea36e3c74fd1c3889c235a76fe44cc
c8e205521
client_nonce: 49d458d116e7f0f64d11e36cf1c42291796e6777f493c6484d82e22
239a4c1fc
server_keyshare: 03009af99de97de5c0b5bb5299c406e53294dc48a78ba4933df0
e01bf8e1c5e46fe1de6e82060a08a9110c435fd784b9ae31ecb639eabd464a1681912
6be3b865b05e9
client_keyshare: 030035c078a34aacc22e0e759115b9c7c45192d97e4970f40376
76039e7bc2d270c3964e81a9009a788b022eac506ac16c9704efe50ff6041bd3c9422
9673d2073d8bc
server_private_keyshare: 00708286c5fb629de5cfea56c0532dd8254a5a6e7fcc
9e51e20a1cf4f254335ca57ce603ae7cf03fc00b7a2d495298d84c8c83b686b67e825
69cb56d97e9c20e5932
client_private_keyshare: 0037735d573abb787b251879b77de4df554c91e25e11
7919a9db2af19b32ce0d501c9572d3a8a106f875023c9722b2de94efaa02c8e46a9e4
8f3e2ee00241f9a75f4
blind_registration: 0071a04b0f2180dda3c36e3d43c3a8f127158d010944b0d53
a6f8da29c3cf4f8695135d645424c747bec642bc91375ff142da4687426b0b4f35c14
eb2477c52e1fff
blind_login: 01eea8a605644334de4987fb60d9aaec15b54fc65ef1e10520556b43
938fbf81d4fbc8c36d787161fa4f1e6cf4f842989634f76f3320fdd24777894218769
fc19651
oprf_key: 0066b06b578fe36ef23a5b9872ade82b9261cc447670debcf78318add68
2f6055089b0a2484abc37f110b36f4c2a140b7a3c53dd8efb6171d3bb4d73591be848
3a1b
~~~

### Intermediate Values

~~~
auth_key: a1bd4cf56b839f3e7f4e13261667d03d0a2c724757f2779c6859a848400
821e59e263b1ac22ef64207b4cb41408a4ef9360f424aa76891a1c85721edd9d75579
prk: 7662cd1a69ef882e6df49b819b8c221aeb952c332eb886cd48d928d084d284b0
c997432f60d19521f5d0e50b92958848249aae5f177008ed0836955082264415
pseudorandom_pad: 2f3f5ebf9c25a006c8866aeb58addc4b0598ae054dd9422e5ec
66540932d559ab0e74c3da43ac52d56b568c22837c4c3833b09738f443183878e65e5
aebb1b56d906
envelope: 0231a698c21261836e5efef74e2ee4c27ca20466e8bf87f927a968b79f5
9a468c800422f48d6a539d833780f1544990269e64ccea60eec4699a27e40adb97c04
7c59472492e1503a59c718a994def69452cf3bb491ab00dc49f7e922b5dc481a4bf61
f4174937d321aaf61d429bb65c0a9e6e1429ebf84ec260ac4deb1b8da1d080f91257b
5e8093f58b468595ec13a735e636c47055113ecfab16392df29067f98afbf158
handshake_secret: 458d9c0a4890403c38a1a3212ea8d65b141eee1c6f9fd93dc0f
0de4814d88053ceced032074b7ec54a90888988784162c7c1b769496a9ec46b94d46b
21db76c7
handshake_encrypt_key: bd428ba2d3bc86d9dfaa57a0a9ecdd5e8227643b2b5af3
7fa265f756fddddbddd233f1aa06be27bb6a52f129a32839d7bc86b37b6c7d131666e
f882a7dcaf2ec
server_mac_key: fa283289bf06a295b11e37b2cc68eec116a4b1af5d9a69c3cc262
555113c524ce39517663ffc0714e686a9242f2430b16c8c3eb0f2e07843fb4170194c
4bc072
client_mac_key: d415dbb87521987f189db6b29a82c3637ed5c0ac42f0bfd7ad395
c699ab997280a7661861dd7897f92e89a9a8e6c85b8115e56361801916916692d3125
88b6a3
~~~

### Output Values

~~~
registration_request: 020197d8111818258667ffbc0d377602f74350b7a54e684
1fb15ba96ac07095bcfc961a2c21e2e0061ba28cd4ea0ed93fa0404f1383b777483c3
31537c8e6e69af85b0
registration_response: 020013e275bf8d4c305cd3793a5be014f9b338b12c6f97
7aef5d523cff2c753b5e6d0f2602fa8359918eaf2fb4ccfb0ae79c383f698ee0fff3a
05d6ce9e5b28e762b0b0300d1df68b2171f58ffc6a2cdf6cd47f4a672e0c06660ad5e
c9cccbd8fafd4593dc847b3a3a7aedd1baf2d03dad24f1da95e884f3554c0d4915b0d
47172f33eab7f0e
registration_upload: 0300ec0addd1ade650f8c2be98b2d7b5b5eb7e1eab56823f
9413327e056e1413055ede83bd893a26f61094a87d108431dc4f95366741da7ec6465
208b9080d17ed304a0231a698c21261836e5efef74e2ee4c27ca20466e8bf87f927a9
68b79f59a468c800422f48d6a539d833780f1544990269e64ccea60eec4699a27e40a
db97c047c59472492e1503a59c718a994def69452cf3bb491ab00dc49f7e922b5dc48
1a4bf61f4174937d321aaf61d429bb65c0a9e6e1429ebf84ec260ac4deb1b8da1d080
f91257b5e8093f58b468595ec13a735e636c47055113ecfab16392df29067f98afbf1
58
KE1: 02013ffd159c4d44f7fe2441c05614ef421e7fc7285432d5dd3b67ada061f3e3
a230d1ab200864a9a716cd001d2a6abea298d58fded61f7d9ce02fc1bb037a1bbf9c7
c49d458d116e7f0f64d11e36cf1c42291796e6777f493c6484d82e22239a4c1fc0009
68656c6c6f20626f62030035c078a34aacc22e0e759115b9c7c45192d97e4970f4037
676039e7bc2d270c3964e81a9009a788b022eac506ac16c9704efe50ff6041bd3c942
29673d2073d8bc
KE2: 0200e302a5573d3625a0f9d0f63398f4c5053d4f816c743ab77bb365a36c3cdd
00fe21ae2a7e56c01f0857ecdb4d129480c189cbe61f78a2aaaa4687126b76a6cf0ce
20300d1df68b2171f58ffc6a2cdf6cd47f4a672e0c06660ad5ec9cccbd8fafd4593dc
847b3a3a7aedd1baf2d03dad24f1da95e884f3554c0d4915b0d47172f33eab7f0e023
1a698c21261836e5efef74e2ee4c27ca20466e8bf87f927a968b79f59a468c800422f
48d6a539d833780f1544990269e64ccea60eec4699a27e40adb97c047c59472492e15
03a59c718a994def69452cf3bb491ab00dc49f7e922b5dc481a4bf61f4174937d321a
af61d429bb65c0a9e6e1429ebf84ec260ac4deb1b8da1d080f91257b5e8093f58b468
595ec13a735e636c47055113ecfab16392df29067f98afbf1589b685b5f0af1f4f42a
5e893e3ea36e3c74fd1c3889c235a76fe44ccc8e20552103009af99de97de5c0b5bb5
299c406e53294dc48a78ba4933df0e01bf8e1c5e46fe1de6e82060a08a9110c435fd7
84b9ae31ecb639eabd464a16819126be3b865b05e9000f20fdb4c622d96d9a06fadf4
31994f552c2fcc3f8b5240b3af28a940b533119fffa1ca908e6b424b91d0e0afee2d4
6e2bb783ecbe19e98cb704c854482c1f0647bbd91d8750f7883a60649f74310e32
KE3: f0527b9c48f529aa4d2be492670f009b1fa9de3db6fcc2be887631ca0b2e37c3
09dd490f84e9ca87e92d1750981f429705c66aab9e3b297a23370d6ceb7b0c00
export_key: c1f9927c635ed0444443a9b70179036bf7721f41823ea289233599082
15f2d81edaf478cb816e858821a47b984380120d4b047ad33890c6e72f7de0205fdc1
7a
session_key: 291434394afc597a203326bc8defb0f1d813b61c715f03a95c6fcf29
ebae88f45bcdd4a0a5c765acfe76cb58e0a0eae45acc0ce2869ea8ae953e4873efa72
3f3
~~~
